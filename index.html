<!doctype html>
<html lang="tr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Matematik Oyunları — Matbilzek</title>
<meta name="description" content="Eğitsel Matematik Oyunları — İlkokul(3. Sınıf), Ortaokul(5.,6.,7. ve 8. sınıf) ve Hafıza oyunları. Mobil uyumlu." />
<link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;700&display=swap" rel="stylesheet">
<link rel="manifest" href="manifest.json">
<link rel="stylesheet" href="styles.css" />
</head>
<body>
<header class="site-header">
<div class="bar">
<a class="logo" href="/">Matematik Oyunları (Basit ve Hızlı) </a>
</div>
<div class="subbar">
<div class="tabs">
<button class="tab active" data-target="home">Ana Sayfa</button>
<button class="tab" data-target="ilkokul3">İLKOKUL (3.Sınıf)</button>
<button class="tab" data-target="ilkokul4">İLKOKUL (4.Sınıf)</button>
<button class="tab" data-target="ortaokul5">ORTAOKUL (5.Sınıf)</button>
<button class="tab" data-target="ortaokul6">ORTAOKUL (6.Sınıf)</button>
<button class="tab" data-target="ortaokul7">ORTAOKUL (7.Sınıf)</button>
<button class="tab" data-target="ortaokul8">ORTAOKUL (8.Sınıf)</button>
<button class="tab" data-target="hafiza">HAFIZA OYUNLARI</button>
</div>
</div>
</header>
<main class="container">
<section id="home" class="panel">
<h1>Hoş geldin! Sınıfını seç ve oyna.</h1>
<p><strong>Kurallar:</strong> Sınırsız süre. Her doğru cevap <strong>10 puan</strong>, arka arkaya <strong>3 doğru</strong> yapınca <strong>+15 bonus puan</strong>!</p>
<div class="cards">
<article class="card"><h4>İLKOKUL(3.Sınıf)</h4><div class="card-actions"><button class="btn go" data-target="ilkokul3">Git</button></div></article>
<article class="card"><h4>İLKOKUL(4.Sınıf)</h4><div class="card-actions"><button class="btn go" data-target="ilkokul4">Git</button></div></article>
<article class="card"><h4>ORTAOKUL(5.Sınıf)</h4><div class="card-actions"><button class="btn go" data-target="ortaokul5">Git</button></div></article> 
<article class="card"><h4>ORTAOKUL(6.Sınıf)</h4><div class="card-actions"><button class="btn go" data-target="ortaokul6">Git</button></div></article>
<article class="card"><h4>ORTAOKUL(7.Sınıf)</h4><div class="card-actions"><button class="btn go" data-target="ortaokul7">Git</button></div></article>
<article class="card"><h4>ORTAOKUL(8.Sınıf)</h4><div class="card-actions"><button class="btn go" data-target="ortaokul8">Git</button></div></article>
<article class="card"><h4>HAFIZA OYUNLARI</h4><div class="card-actions"><button class="btn go" data-target="hafiza">Git</button></div></article>
</div>
</section>

<section id="ilkokul3" class="panel hidden">
<h2>İLKOKUL(3.Sınıf) OYUNLARI </h2>
<div class="cards">
<article class="card"><h3>Toplama</h3><div class="card-actions"><button class="btn go" data-target="addition">Oyna</button></div></article>
<article class="card"><h3>Çıkarma</h3><div class="card-actions"><button class="btn go" data-target="subtraction">Oyna</button></div></article>
<article class="card"><h3>Çarpma</h3><div class="card-actions"><button class="btn go" data-target="multiplication">Oyna</button></div></article>
<article class="card"><h3>Bölme</h3><div class="card-actions"><button class="btn go" data-target="division">Oyna</button></div></article>
</div>
<div class="back"><button class="btn tab" data-target="home">Geri</button></div>
</section>

<section id="ilkokul4" class="panel hidden">
<h2>İLKOKUL(4.Sınıf) OYUNLARI </h2>
<div class="cards">
<article class="card"><h3>Toplama</h3><div class="card-actions"><button class="btn go" data-target="addition">Oyna</button></div></article>
<article class="card"><h3>Çıkarma</h3><div class="card-actions"><button class="btn go" data-target="subtraction">Oyna</button></div></article>
<article class="card"><h3>Çarpma</h3><div class="card-actions"><button class="btn go" data-target="multiplication">Oyna</button></div></article>
<article class="card"><h3>Bölme</h3><div class="card-actions"><button class="btn go" data-target="division">Oyna</button></div></article>
</div>
<div class="back"><button class="btn tab" data-target="home">Geri</button></div>
</section>  

<section id="ortaokul5" class="panel hidden">
<h2>ORTAOKUL(5.Sınıf) OYUNLARI</h2>
<div class="cards">
<article class="card"><h3>Geometri Oyunu</h3><div class="card-actions"><button class="btn go" data-target="geometryGame">Oyna</button></div></article>
<article class="card"><h3>Açı Tahmin Oyunu</h3><div class="card-actions"><button class="btn go" data-target="angleGame">Oyna</button></div></article>
<article class="card"><h3>Çemberden Üçgene </h3><div class="card-actions"><button class="btn go" data-target="triangleCircleGame">Oyna</button></div></article>
<article class="card"><h3>Çok Basamaklı Sayılar</h3><div class="card-actions"><button class="btn go" data-target="numberGame">Oyna</button></div></article>
<article class="card"><h3>Doğal Sayılarla Problemler</h3><div class="card-actions"><button class="btn go" data-target="problemGame">Oyna</button></div></article>
<article class="card"><h3>Dikdörtgen Çevresi ve Alanı</h3><div class="card-actions"><button class="btn go" data-target="rectAreaPerimeterGame">Oyna</button></div></article>
</div>
<div class="back"><button class="btn tab" data-target="home">Geri</button></div>
</section>

<section id="ortaokul6" class="panel hidden">
<h2>ORTAOKUL(6.Sınıf) OYUNLARI</h2>
<div class="cards">
<article class="card"><h3>Asal Sayılar</h3><div class="card-actions"><button class="btn go" data-target="primes">Oyna</button></div></article>
<article class="card"><h3>Çarpanlar</h3><div class="card-actions"><button class="btn go" data-target="factors">Oyna</button></div></article>
<article class="card"><h3>Ortak Bölen / Ortak Kat</h3><div class="card-actions"><button class="btn go" data-target="gcdlcm">Oyna</button></div></article>
<article class="card"><h3>Denk Kesirler</h3><div class="card-actions"><button class="btn go" data-target="frac6">Oyna</button></div></article>
<article class="card"><h3>Tam Sayılı → Bileşik</h3><div class="card-actions"><button class="btn go" data-target="mixed">Oyna</button></div></article>
<article class="card"><h3>Ortalama / Ortanca / Tepe</h3><div class="card-actions"><button class="btn go" data-target="stats">Oyna</button></div></article>
</div>
<div class="back"><button class="btn tab" data-target="home">Geri</button></div>
</section>

<section id="ortaokul7" class="panel hidden">
<h2>ORTAOKUL(7.Sınıf) OYUNLARI</h2>
<div class="cards">
<article class="card"><h3>Tam Sayılarla Toplama ve Çıkarma</h3><div class="card-actions"><button class="btn go" data-target="integerGame">Oyna</button></div></article>
<article class="card"><h3>Tam Sayılarla Çarpma ve Bölme</h3><div class="card-actions"><button class="btn go" data-target="integerMulDivGame">Oyna</button></div></article>
<article class="card"><h3>Rasyonel Sayıları Ondalık Sayıya Çevirme</h3><div class="card-actions"><button class="btn go" data-target="rationalToDecimalGame">Oyna</button></div></article>
<article class="card"><h3>Rasyonel Sayılarla Toplama ve Çıkarma</h3><div class="card-actions"><button class="btn go" data-target="rationalOpGame">Oyna</button></div></article>
<article class="card"><h3>Rasyonel Sayılarla Çarpma ve Bölme</h3><div class="card-actions"><button class="btn go" data-target="rationalMulDivGame">Oyna</button></div></article>
<article class="card"><h3>Rasyonel Sayılarla Çok Adımlı İşlemler</h3><div class="card-actions"><button class="btn go" data-target="multiStepRationalGame">Oyna</button></div></article>
</div>
<div class="back"><button class="btn tab" data-target="home">Geri</button></div>
</section>

<section id="ortaokul8" class="panel hidden">
<h2>ORTAOKUL(8.Sınıf) OYUNLARI</h2>
<div class="cards">
<article class="card"><h3>Sayıların Çarpanlarını Üslü İfade Şeklinde Yazma</h3><div class="card-actions"><button class="btn go" data-target="factorsGame">Oyna</button></div></article>
<article class="card"><h3>EBOB-EKOK Bulma</h3><div class="card-actions"><button class="btn go" data-target="ebobEkokGame">Oyna</button></div></article>
<article class="card"><h3>Aralarında Asal Olan Sayıyı Bulma</h3><div class="card-actions"><button class="btn go" data-target="coprimeGame">Oyna</button></div></article>
<article class="card"><h3>Tam Sayıların Kuvvetleri</h3><div class="card-actions"><button class="btn go" data-target="integerPowerGame">Oyna</button></div></article>
<article class="card"><h3>Üslü Sayılarla İşlemler</h3><div class="card-actions"><button class="btn go" data-target="combinedPowerGame">Oyna</button></div></article>
<article class="card"><h3>Ortalama / Ortanca / Tepe</h3><div class="card-actions"><button class="btn go" data-target="stats">Oyna</button></div></article>
</div>
<div class="back"><button class="btn tab" data-target="home">Geri</button></div>
</section>

<section id="hafiza" class="panel hidden">
<h2>HAFIZA OYUNLARI</h2>
<div class="cards">
<article class="card"><h3>Şekiller</h3><div class="card-actions"><button class="btn go" data-target="shapes">Oyna</button></div></article>
<article class="card"><h3>Hafıza Kartları</h3><div class="card-actions"><button class="btn go" data-target="memory">Oyna</button></div></article>
</div>
<div class="back"><button class="btn tab" data-target="home">Geri</button></div>
</section>

<!-- Tüm Oyun Panelleri -->
<section id="addition" class="panel hidden">
<h2>Toplama Oyunu</h2>
<div class="game-area">
<div class="status-row">
<span>Skor: <span id="add-score">0</span></span>
<span>Süre: <span> Sınırsız </span></span>
</div>
<div class="question" id="add-question"></div>
<div class="answers" id="add-answers"></div>
</div>
<div class="game-header controls" style="margin-top:1rem;">
<button class="btn" onclick="window.renderLeaderboardForGame('addition')">En Yüksek Skorlar</button>
<button class="btn" onclick="window.submitScoreUI('addition')">Bitir ve Skor Gönder</button>
<button class="btn tab" data-target="ilkokul">Geri</button>
</div>
</section>

<section id="subtraction" class="panel hidden">
<h2>Çıkarma Oyunu</h2>
<div class="game-area">
<div class="status-row">
<span>Skor: <span id="sub-score">0</span></span>
<span>Süre: <span> Sınırsız </span></span>
</div>
<div class="question" id="sub-question"></div>
<div class="answers" id="sub-answers"></div>
</div>
<div class="game-header controls" style="margin-top:1rem;">
<button class="btn" onclick="window.renderLeaderboardForGame('subtraction')">En Yüksek Skorlar</button>
<button class="btn" onclick="window.submitScoreUI('subtraction')">Bitir ve Skor Gönder</button>
<button class="btn tab" data-target="ilkokul">Geri</button>
</div>
</section>

<section id="multiplication" class="panel hidden">
<h2>Çarpma Oyunu</h2>
<div class="game-area">
<div class="status-row">
<span>Skor: <span id="mul-score">0</span></span>
<span>Süre: <span> Sınırsız </span></span>
</div>
<div class="question" id="mul-question"></div>
<div class="answers" id="mul-answers"></div>
</div>
<div class="game-header controls" style="margin-top:1rem;">
<button class="btn" onclick="window.renderLeaderboardForGame('multiplication')">En Yüksek Skorlar</button>
<button class="btn" onclick="window.submitScoreUI('multiplication')">Bitir ve Skor Gönder</button>
<button class="btn tab" data-target="ilkokul">Geri</button>
</div>
</section>

<section id="division" class="panel hidden">
<h2>Bölme Oyunu</h2>
<div class="game-area">
<div class="status-row">
<span>Skor: <span id="div-score">0</span></span>
<span>Süre: <span> Sınırsız </span></span>
</div>
<div class="question" id="div-question"></div>
<div class="answers" id="div-answers"></div>
</div>
<div class="game-header controls" style="margin-top:1rem;">
<button class="btn" onclick="window.renderLeaderboardForGame('division')">En Yüksek Skorlar</button>
<button class="btn" onclick="window.submitScoreUI('division')">Bitir ve Skor Gönder</button>
<button class="btn tab" data-target="ilkokul">Geri</button>
</div>
</section>

<section id="geometryGame" class="panel hidden">
  <h2>Geometri Oyunu</h2>
  <div class="game-area">
    <div class="status-row">
      <span>Skor: <span id="geo-score">0</span></span>
      <span>Süre: <span> Sınırsız </span></span>    </div>
    <div class="question" id="geo-question" style="font-size: 60px; height: 120px; display: flex; align-items: center; justify-content: center; background: #eee; border-radius: 8px; margin-bottom: 15px;"></div>
    <div class="answers" id="geo-answers"></div>
  </div>
  <div class="game-header controls" style="margin-top:1rem;">
    <button class="btn" onclick="window.renderLeaderboardForGame('geometryGame')">En Yüksek Skorlar</button>
    <button class="btn" onclick="window.submitScoreUI('geometryGame')">Bitir ve Skor Gönder</button>
    <button class="btn tab" data-target="ortaokul5">Geri</button>
  </div>
</section>

  <section id="angleGame" class="panel hidden">
  <h2>Açı Tahmin Oyunu</h2>
  <div class="game-area">
    <div class="status-row">
      <span>Skor: <span id="angle-score">0</span></span>
      <span>Süre: <span> Sınırsız </span></span>
    </div>
    
    <div id="angle-visual-container" style="background: white; border-radius: 10px; margin: 15px 0; display: flex; justify-content: center; align-items: center; padding: 20px;">
        <svg id="angle-svg" width="200" height="200" viewBox="0 0 200 200">
            <path id="angle-path" d="" fill="none" stroke="#333" stroke-width="3" />
            <circle cx="100" cy="150" r="4" fill="red" /> </svg>
    </div>

    <div class="question" id="angle-question" style="font-weight: bold; margin-bottom: 10px;">Bu açı kaç derece olabilir?</div>
    <div class="answers" id="angle-answers"></div>
  </div>

  <div class="game-header controls" style="margin-top:1rem;">
    <button class="btn" onclick="window.renderLeaderboardForGame('angleGame')">En Yüksek Skorlar</button>
    <button class="btn" onclick="window.submitScoreUI('angleGame')">Bitir ve Skor Gönder</button>
    <button class="btn tab" data-target="ortaokul5">Geri</button>
  </div>
</section>

<section id="triangleCircleGame" class="panel hidden">
  <h2>Çember ve Üçgen İlişkisi</h2>
  <div class="game-area">
    <div class="status-row">
      <span>Skor: <span id="tri-score">0</span></span>
      <span>Süre: <span>Sınırsız</span></span>
    </div>
    
    <div style="background: white; border-radius: 10px; margin: 15px 0; display: flex; justify-content: center; align-items: center; padding: 10px;">
        <svg id="tri-svg" width="250" height="200" viewBox="0 0 250 200">
            </svg>
    </div>

    <div class="question" style="font-weight: bold; margin-bottom: 10px;">
        Merkezler ve kesişim noktasıyla oluşan üçgen hangisidir?
    </div>
    <div class="answers" id="tri-answers"></div>
  </div>

  <div class="game-header controls" style="margin-top:1rem;">
    <button class="btn" onclick="window.renderLeaderboardForGame('triangleCircleGame')">En Yüksek Skorlar</button>
    <button class="btn" onclick="window.submitScoreUI('triangleCircleGame')">Bitir ve Skor Gönder</button>
    <button class="btn tab" data-target="ortaokul5">Geri</button>
  </div>
</section>

  <section id="numberGame" class="panel hidden">
  <h2>Çok Basamaklı Sayılar</h2>
  <div class="game-area">
    <div class="status-row">
      <span>Skor: <span id="num-score">0</span></span>
      <span>Süre: <span>Sınırsız</span></span>
    </div>
    
    <div class="question-container" style="background: #fdf6e3; padding: 20px; border-radius: 10px; margin-bottom: 15px; text-align: center; border: 2px solid #ddd;">
        <div id="num-display" style="font-size: 28px; font-weight: bold; color: #2c3e50; letter-spacing: 2px; margin-bottom: 10px; font-family: monospace;"></div>
        <div id="num-question-text" style="font-size: 18px; color: #d35400; font-weight: bold; min-height: 1.5em;"></div>
    </div>

    <div class="answers" id="num-answers" style="display: flex; flex-direction: column; gap: 8px;"></div>
  </div>

  <div class="game-header controls" style="margin-top:1rem;">
    <button class="btn" onclick="window.renderLeaderboardForGame('numberGame')">En Yüksek Skorlar</button>
    <button class="btn" onclick="window.submitScoreUI('numberGame')">Bitir ve Skor Gönder</button>
    <button class="btn tab" data-target="ortaokul5">Geri</button>
  </div>
</section>

  <section id="problemGame" class="panel hidden">
  <h2>Gerçek Yaşam Problemleri</h2>
  <div class="game-area">
    <div class="status-row">
      <span>Skor: <span id="prob-score">0</span></span>
      <span>Süre: <span>Sınırsız</span></span>
    </div>
    
    <div class="question-container" style="background: #eef2f3; padding: 25px; border-radius: 12px; margin-bottom: 20px; border-left: 5px solid #3498db;">
        <div id="prob-text" style="font-size: 1.2rem; line-height: 1.6; color: #2c3e50; font-weight: 500;">
            Problem yükleniyor...
        </div>
    </div>

    <div class="answers" id="prob-answers" style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
        </div>
  </div>

  <div class="game-header controls" style="margin-top:1rem;">
    <button class="btn" onclick="window.renderLeaderboardForGame('problemGame')">En Yüksek Skorlar</button>
    <button class="btn" onclick="window.submitScoreUI('problemGame')">Bitir ve Skor Gönder</button>
    <button class="btn tab" data-target="ortaokul5">Geri</button>
  </div>
</section>


  <section id="rectAreaPerimeterGame" class="panel hidden">
  <h2>Dikdörtgen: Alan ve Çevre İlişkisi</h2>
  <div class="game-area">
    <div class="status-row">
      <span>Skor: <span id="rect-score">0</span></span>
      <span>Süre: <span>Sınırsız</span></span>
    </div>
    
    <div style="background: white; border-radius: 10px; margin: 15px 0; display: flex; justify-content: center; align-items: center; padding: 20px; border: 1px solid #ddd;">
        <svg id="rect-svg" width="200" height="150" viewBox="0 0 200 150">
            <rect id="rect-shape" x="50" y="40" width="100" height="70" fill="rgba(52, 152, 219, 0.2)" stroke="#2980b9" stroke-width="3" />
            <text id="rect-label-top" x="100" y="30" text-anchor="middle" font-size="14" fill="#2c3e50"></text>
            <text id="rect-label-side" x="40" y="75" text-anchor="end" font-size="14" fill="#2c3e50"></text>
        </svg>
    </div>

    <div class="question" id="rect-question" style="font-weight: bold; color: #d35400; margin-bottom: 15px; min-height: 3em;">
        Soru yükleniyor...
    </div>
    <div class="answers" id="rect-answers"></div>
  </div>

  <div class="game-header controls" style="margin-top:1rem;">
    <button class="btn" onclick="window.renderLeaderboardForGame('rectAreaPerimeterGame')">En Yüksek Skorlar</button>
    <button class="btn" onclick="window.submitScoreUI('rectAreaPerimeterGame')">Bitir ve Skor Gönder</button>
    <button class="btn tab" data-target="ortaokul5">Geri</button>
  </div>
</section>
  
  
<section id="primes" class="panel hidden">
<h2>Asal Sayılar Oyunu</h2>
<div class="game-area">
<div class="status-row">
<span>Skor: <span id="prime-score">0</span></span>
<span>Süre: <span> Sınırsız </span></span>
</div>
<div class="question" id="prime-question"></div>
<div class="answers" id="prime-answers"></div>
</div>
<div class="game-header controls" style="margin-top:1rem;">
<button class="btn" onclick="window.renderLeaderboardForGame('primes')">En Yüksek Skorlar</button>
<button class="btn" onclick="window.submitScoreUI('primes')">Bitir ve Skor Gönder</button>
<button class="btn tab" data-target="ortaokul6">Geri</button>
</div>
</section>

<section id="factors" class="panel hidden">
<h2>Çarpanlar Oyunu</h2>
<div class="game-area">
<div class="status-row">
<span>Skor: <span id="fac-score">0</span></span>
<span>Süre: <span> Sınırsız </span></span>
</div>
<div class="question" id="fac-question"></div>
<div class="answers" id="fac-answers"></div>
</div>
<div class="game-header controls" style="margin-top:1rem;">
<button class="btn" onclick="window.renderLeaderboardForGame('factors')">En Yüksek Skorlar</button>
<button class="btn" onclick="window.submitScoreUI('factors')">Bitir ve Skor Gönder</button>
<button class="btn tab" data-target="ortaokul6">Geri</button>
</div>
</section>

<section id="gcdlcm" class="panel hidden">
<h2>Ortak Bölen / Ortak Kat Oyunu</h2>
<div class="game-area">
<div class="status-row">
<span>Skor: <span id="gcd-score">0</span></span>
<span>Süre: <span> Sınırsız </span></span>
</div>
<div class="question" id="gcd-question"></div>
<div class="answers" id="gcd-answers"></div>
</div>
<div class="game-header controls" style="margin-top:1rem;">
<button class="btn" onclick="window.renderLeaderboardForGame('gcdlcm')">En Yüksek Skorlar</button>
<button class="btn" onclick="window.submitScoreUI('gcdlcm')">Bitir ve Skor Gönder</button>
<button class="btn tab" data-target="ortaokul6">Geri</button>
</div>
</section>

<section id="frac6" class="panel hidden">
<h2>Denk Kesirler Oyunu</h2>
<div class="game-area">
<div class="status-row">
<span>Skor: <span id="frac-score">0</span></span>
<span>Süre: <span> Sınırsız </span></span>
</div>
<div class="question" id="frac-question"></div>
<div class="answers" id="frac-answers"></div>
</div>
<div class="game-header controls" style="margin-top:1rem;">
<button class="btn" onclick="window.renderLeaderboardForGame('frac6')">En Yüksek Skorlar</button>
<button class="btn" onclick="window.submitScoreUI('frac6')">Bitir ve Skor Gönder</button>
<button class="btn tab" data-target="ortaokul6">Geri</button>
</div>
</section>

<section id="mixed" class="panel hidden">
<h2>Tam Sayılı → Bileşik Kesir</h2>
<div class="game-area">
<div class="status-row">
<span>Skor: <span id="mix-score">0</span></span>
<span>Süre: <span> Sınırsız </span></span>
</div>
<div class="question" id="mix-question"></div>
<div class="answers" id="mix-answers"></div>
</div>
<div class="game-header controls" style="margin-top:1rem;">
<button class="btn" onclick="window.renderLeaderboardForGame('mixed')">En Yüksek Skorlar</button>
<button class="btn" onclick="window.submitScoreUI('mixed')">Bitir ve Skor Gönder</button>
<button class="btn tab" data-target="ortaokul6">Geri</button>
</div>
</section>

<section id="stats" class="panel hidden">
<h2>Ortalama / Ortanca / Tepe Değer</h2>
<div class="game-area">
<div class="status-row">
<span>Skor: <span id="stat-score">0</span></span>
<span>Süre: <span> Sınırsız </span></span>
</div>
<div class="question" id="stat-question"></div>
<div class="answers" id="stat-answers"></div>
</div>
<div class="game-header controls" style="margin-top:1rem;">
<button class="btn" onclick="window.renderLeaderboardForGame('stats')">En Yüksek Skorlar</button>
<button class="btn" onclick="window.submitScoreUI('stats')">Bitir ve Skor Gönder</button>
<button class="btn tab" data-target="ortaokul6">Geri</button>
</div>
</section>

<section id="integerGame" class="panel hidden">
  <h2>Tam Sayılarla Toplama ve Çıkarma</h2>
  <div class="game-area">
    <div class="status-row">
      <span>Skor: <span id="int-score">0</span></span>
      <span>Süre: <span>Sınırsız</span></span>
    </div>
    
    <div class="question-container" style="background: #2c3e50; padding: 30px; border-radius: 15px; margin-bottom: 20px; text-align: center;">
        <div id="int-question" style="font-size: 42px; font-weight: bold; color: #ecf0f1; font-family: 'Courier New', Courier, monospace;">
            (-5) + (+8) = ?
        </div>
    </div>

    <div class="answers" id="int-answers" style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
        </div>
  </div>

  <div class="game-header controls" style="margin-top:1rem;">
    <button class="btn" onclick="window.renderLeaderboardForGame('integerGame')">En Yüksek Skorlar</button>
    <button class="btn" onclick="window.submitScoreUI('integerGame')">Bitir ve Skor Gönder</button>
    <button class="btn tab" data-target="ortaokul7">Geri</button>
  </div>
</section>


  <section id="integerMulDivGame" class="panel hidden">
  <h2>Tam Sayılarla Çarpma ve Bölme</h2>
  <div class="game-area">
    <div class="status-row">
      <span>Skor: <span id="intmd-score">0</span></span>
      <span>Süre: <span>Sınırsız</span></span>
    </div>
    
    <div class="question-container" style="background: #1e272e; padding: 30px; border-radius: 15px; margin-bottom: 20px; text-align: center; border: 3px solid #f39c12;">
        <div id="intmd-question" style="font-size: 38px; font-weight: bold; color: #f1c40f; font-family: 'Courier New', Courier, monospace; letter-spacing: 2px;">
            (-4) × (+3) = ?
        </div>
    </div>

    <div class="answers" id="intmd-answers" style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
        </div>
  </div>

  <div class="game-header controls" style="margin-top:1rem;">
    <button class="btn" onclick="window.renderLeaderboardForGame('integerMulDivGame')">En Yüksek Skorlar</button>
    <button class="btn" onclick="window.submitScoreUI('integerMulDivGame')">Bitir ve Skor Gönder</button>
    <button class="btn tab" data-target="ortaokul7">Geri</button>
  </div>
</section>

<section id="rationalToDecimalGame" class="panel hidden">
  <h2>Rasyonel Sayıları Ondalık Sayıya Çevirme</h2>
  <div class="game-area">
    <div class="status-row">
      <span>Skor: <span id="rat-score">0</span></span>
      <span>Süre: <span>Sınırsız</span></span>
    </div>
    
    <div class="question-container" style="background: #fff; padding: 25px; border-radius: 15px; margin-bottom: 20px; text-align: center; border: 2px dashed #9b59b6; display: flex; flex-direction: column; align-items: center; justify-content: center;">
        <div style="font-size: 18px; color: #8e44ad; margin-bottom: 10px; font-weight: bold;">Aşağıdaki kesrin ondalık gösterimi hangisidir?</div>
        <div style="display: flex; flex-direction: column; align-items: center; font-size: 32px; font-weight: bold; font-family: 'serif';">
            <div id="rat-num">1</div>
            <div style="width: 50px; height: 3px; background: #2c3e50; margin: 2px 0;"></div>
            <div id="rat-den">3</div>
        </div>
    </div>

    <div class="answers" id="rat-answers" style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
        </div>
  </div>

  <div class="game-header controls" style="margin-top:1rem;">
    <button class="btn" onclick="window.renderLeaderboardForGame('rationalToDecimalGame')">En Yüksek Skorlar</button>
    <button class="btn" onclick="window.submitScoreUI('rationalToDecimalGame')">Bitir ve Skor Gönder</button>
    <button class="btn tab" data-target="ortaokul7">Geri</button>
  </div>
</section>

  
  <section id="rationalOpGame" class="panel hidden">
  <h2>Rasyonel Sayılarla Toplama ve Çıkarma</h2>
  <div class="game-area">
    <div class="status-row">
      <span>Skor: <span id="ratop-score">0</span></span>
      <span>Süre: <span>Sınırsız</span></span>
    </div>
    
    <div class="question-container" style="background: #f4f7f6; padding: 25px; border-radius: 15px; margin-bottom: 20px; text-align: center; border: 2px solid #34495e; display: flex; align-items: center; justify-content: center; gap: 15px;">
        <div class="fraction-box" style="display: flex; flex-direction: column; align-items: center; font-size: 28px; font-weight: bold;">
            <div id="ratop-n1">1</div>
            <div style="width: 40px; height: 3px; background: #2c3e50; margin: 2px 0;"></div>
            <div id="ratop-d1">2</div>
        </div>
        
        <div id="ratop-op" style="font-size: 32px; font-weight: bold;">+</div>

        <div class="fraction-box" style="display: flex; flex-direction: column; align-items: center; font-size: 28px; font-weight: bold;">
            <div id="ratop-n2">1</div>
            <div style="width: 40px; height: 3px; background: #2c3e50; margin: 2px 0;"></div>
            <div id="ratop-d2">4</div>
        </div>

        <div style="font-size: 32px; font-weight: bold;">= ?</div>
    </div>

    <div class="answers" id="ratop-answers" style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
        </div>
  </div>

  <div class="game-header controls" style="margin-top:1rem;">
    <button class="btn" onclick="window.renderLeaderboardForGame('rationalOpGame')">En Yüksek Skorlar</button>
    <button class="btn" onclick="window.submitScoreUI('rationalOpGame')">Bitir ve Skor Gönder</button>
    <button class="btn tab" data-target="ortaokul7">Geri</button>
  </div>
</section>

<section id="rationalMulDivGame" class="panel hidden">
  <h2>Rasyonel Sayılarla Çarpma ve Bölme</h2>
  <div class="game-area">
    <div class="status-row">
      <span>Skor: <span id="ratmd-score">0</span></span>
      <span>Süre: <span>Sınırsız</span></span>
    </div>
    
    <div class="question-container" style="background: #fff5e6; padding: 25px; border-radius: 15px; margin-bottom: 20px; text-align: center; border: 2px solid #e67e22; display: flex; align-items: center; justify-content: center; gap: 15px;">
        <div class="fraction-box" style="display: flex; flex-direction: column; align-items: center; font-size: 28px; font-weight: bold;">
            <div id="ratmd-n1">2</div>
            <div style="width: 40px; height: 3px; background: #2c3e50; margin: 2px 0;"></div>
            <div id="ratmd-d1">3</div>
        </div>
        
        <div id="ratmd-op" style="font-size: 32px; font-weight: bold; color: #d35400;">×</div>

        <div class="fraction-box" style="display: flex; flex-direction: column; align-items: center; font-size: 28px; font-weight: bold;">
            <div id="ratmd-n2">1</div>
            <div style="width: 40px; height: 3px; background: #2c3e50; margin: 2px 0;"></div>
            <div id="ratmd-d2">4</div>
        </div>

        <div style="font-size: 32px; font-weight: bold;">= ?</div>
    </div>

    <div class="answers" id="ratmd-answers" style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
        </div>
  </div>

  <div class="game-header controls" style="margin-top:1rem;">
    <button class="btn" onclick="window.renderLeaderboardForGame('rationalMulDivGame')">En Yüksek Skorlar</button>
    <button class="btn" onclick="window.submitScoreUI('rationalMulDivGame')">Bitir ve Skor Gönder</button>
    <button class="btn tab" data-target="ortaokul7">Geri</button>
  </div>
</section>


  <section id="multiStepRationalGame" class="panel hidden">
  <h2>Rasyonel Sayılarla Çok Adımlı İşlemler</h2>
  <div class="game-area">
    <div class="status-row">
      <span>Skor: <span id="msr-score">0</span></span>
      <span>Süre: <span>Sınırsız</span></span>
    </div>
    
    <div class="question-container" style="background: #fdfdfd; padding: 30px; border-radius: 15px; margin-bottom: 20px; text-align: center; border: 2px solid #2980b9; min-height: 200px; display: flex; align-items: center; justify-content: center;">
        <div id="msr-question" style="font-size: 24px; font-weight: bold; font-family: 'serif';">
            Yükleniyor...
        </div>
    </div>

    <div class="answers" id="msr-answers" style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
        </div>
  </div>

  <div class="game-header controls" style="margin-top:1rem;">
    <button class="btn" onclick="window.renderLeaderboardForGame('multiStepRationalGame')">En Yüksek Skorlar</button>
    <button class="btn" onclick="window.submitScoreUI('multiStepRationalGame')">Bitir ve Skor Gönder</button>
    <button class="btn tab" data-target="ortaokul7">Geri</button>
  </div>
</section>


<section id="factorsGame" class="panel hidden">
  <h2>Sayıların Çarpanlarını Üslü İfade Şeklinde Yazma</h2>
  <div class="game-area">
    <div class="status-row">
      <span>Skor: <span id="fact-score">0</span></span>
      <span>Süre: <span>Sınırsız</span></span>
    </div>
    
    <div class="question-container" style="background: #fdfdfd; padding: 25px; border-radius: 15px; margin-bottom: 20px; text-align: center; border: 3px solid #27ae60;">
        <div id="fact-question-text" style="font-size: 18px; color: #2c3e50; margin-bottom: 10px;">Aşağıdaki sayının asal çarpanlarına ayrılmış hali hangisidir?</div>
        <div id="fact-number" style="font-size: 48px; font-weight: bold; color: #27ae60; font-family: 'serif';">60</div>
    </div>

    <div class="answers" id="fact-answers" style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
        </div>
  </div>

  <div class="game-header controls" style="margin-top:1rem;">
    <button class="btn" onclick="window.renderLeaderboardForGame('factorsGame')">En Yüksek Skorlar</button>
    <button class="btn" onclick="window.submitScoreUI('factorsGame')">Bitir ve Skor Gönder</button>
    <button class="btn tab" data-target="ortaokul8">Geri</button>
  </div>
</section>  


  <section id="ebobEkokGame" class="panel hidden">
  <h2>EBOB-EKOK Bulma</h2>
  <div class="game-area">
    <div class="status-row">
      <span>Skor: <span id="ee-score">0</span></span>
      <span>Süre: <span>Sınırsız</span></span>
    </div>
    
    <div class="question-container" style="background: #fff; padding: 25px; border-radius: 15px; margin-bottom: 20px; text-align: center; border: 3px solid #e74c3c;">
        <div id="ee-question-text" style="font-size: 20px; color: #34495e; margin-bottom: 15px; font-weight: bold;">Sayıların EBOB'u kaçtır?</div>
        <div style="font-size: 36px; font-weight: bold; color: #e74c3c;">
            <span id="ee-num1">12</span> ve <span id="ee-num2">18</span>
        </div>
    </div>

    <div class="answers" id="ee-answers" style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
        </div>
  </div>

  <div class="game-header controls" style="margin-top:1rem;">
    <button class="btn" onclick="window.renderLeaderboardForGame('ebobEkokGame')">En Yüksek Skorlar</button>
    <button class="btn" onclick="window.submitScoreUI('ebobEkokGame')">Bitir ve Skor Gönder</button>
    <button class="btn tab" data-target="ortaokul8">Geri</button>
  </div>
</section>


  <section id="coprimeGame" class="panel hidden">
  <h2>Aralarında Asal Olan Sayıyı Bulma</h2>
  <div class="game-area">
    <div class="status-row">
      <span>Skor: <span id="cp-score">0</span></span>
      <span>Süre: <span>Sınırsız</span></span>
    </div>
    
    <div class="question-container" style="background: #f8f9fa; padding: 30px; border-radius: 15px; margin-bottom: 20px; text-align: center; border: 3px solid #3498db;">
        <div id="cp-question-text" style="font-size: 20px; color: #2c3e50; margin-bottom: 15px;">Bu sayılar aralarında asal mıdır?</div>
        <div style="font-size: 42px; font-weight: bold; color: #3498db; letter-spacing: 2px;">
            <span id="cp-num1">15</span> ve <span id="cp-num2">28</span>
        </div>
    </div>

    <div class="answers" id="cp-answers" style="display: flex; justify-content: center; gap: 20px;">
        </div>
  </div>

  <div class="game-header controls" style="margin-top:1rem;">
    <button class="btn" onclick="window.renderLeaderboardForGame('coprimeGame')">En Yüksek Skorlar</button>
    <button class="btn" onclick="window.submitScoreUI('coprimeGame')">Bitir ve Skor Gönder</button>
    <button class="btn tab" data-target="ortaokul8">Geri</button>
  </div>
</section>


<section id="integerPowerGame" class="panel hidden">
  <h2>Tam Sayıların Kuvvetleri</h2>
  <div class="game-area">
    <div class="status-row">
      <span>Skor: <span id="pow-score">0</span></span>
      <span>Süre: <span>Sınırsız</span></span>
    </div>
    
    <div class="question-container" style="background: #2d3436; padding: 40px; border-radius: 15px; margin-bottom: 20px; text-align: center; border: 3px solid #0984e3;">
        <div id="pow-display" style="font-size: 64px; font-weight: bold; color: #fab1a0; font-family: 'serif'; letter-spacing: 2px;">
            <span id="pow-base">(-2)</span><sup id="pow-exponent" style="font-size: 36px; color: #74b9ff;">3</sup>
        </div>
        <div style="color: #dfe6e9; margin-top: 15px; font-size: 18px;">İşleminin sonucu kaçtır?</div>
    </div>

    <div class="answers" id="pow-answers" style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
        </div>
  </div>

  <div class="game-header controls" style="margin-top:1rem;">
    <button class="btn" onclick="window.renderLeaderboardForGame('integerPowerGame')">En Yüksek Skorlar</button>
    <button class="btn" onclick="window.submitScoreUI('integerPowerGame')">Bitir ve Skor Gönder</button>
    <button class="btn tab" data-target="ortaokul8">Geri</button>
  </div>
</section>

<section id="combinedPowerGame" class="panel hidden">
  <h2>Üslü Sayılarla İşlemler</h2>
  <div class="game-area">
    <div class="status-row">
      <span>Skor: <span id="comb-score">0</span></span>
      <span>Süre: <span>Sınırsız</span></span>
    </div>
    
    <div class="question-container" style="background: #1e272e; padding: 35px; border-radius: 20px; margin-bottom: 20px; text-align: center; border: 4px solid #fbc531;">
        <div id="comb-hint" style="font-size: 18px; color: #f5f6fa; margin-bottom: 15px; opacity: 0.8;">İşlemi yap ve sonucu bul:</div>
        <div id="comb-question" style="font-size: 42px; font-weight: bold; color: #fbc531; font-family: 'serif';">
            2<sup>3</sup> · 2<sup>4</sup> = ?
        </div>
    </div>

    <div class="answers" id="comb-answers" style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
        </div>
  </div>

  <div class="game-header controls" style="margin-top:1rem;">
    <button class="btn" onclick="window.renderLeaderboardForGame('combinedPowerGame')">En Yüksek Skorlar</button>
    <button class="btn" onclick="window.submitScoreUI('combinedPowerGame')">Bitir ve Skor Gönder</button>
    <button class="btn tab" data-target="ortaokul5">Geri</button>
  </div>
</section>

  
<section id="shapes" class="panel hidden">
<h2>Şekiller Oyunu</h2>
<div class="game-area">
<div class="status-row">
<span>Skor: <span id="shape-score">0</span></span>
<span>Süre: <span> Sınırsız </span></span>
</div>
<div class="question" style="font-size:1.4rem;margin-bottom:1rem;">Hedef: <div id="target-shape-display" class="shape" style="display:inline-block;margin-left:1rem;"></div></div>
<div class="mem-board" id="shape-board" style="grid-template-columns:repeat(4,1fr);"></div>
</div>
<div class="game-header controls" style="margin-top:1rem;">
<button class="btn" onclick="window.renderLeaderboardForGame('shapes')">En Yüksek Skorlar</button>
<button class="btn" onclick="window.submitScoreUI('shapes')">Bitir ve Skor Gönder</button>
<button class="btn tab" data-target="hafiza">Geri</button>
</div>
</section>

<section id="memory" class="panel hidden">
<h2>Hafıza Kartları</h2>
<div class="game-area">
<div class="status-row">
<span>Skor: <span id="mem-score">0</span></span>
<span>Süre: <span> Sınırsız </span></span>
<span>Çift: <span id="mem-pairs">0</span>/8</span>
</div>
<div class="mem-board" id="mem-board"></div>
</div>
<div class="game-header controls" style="margin-top:1rem;">
<button class="btn" onclick="window.renderLeaderboardForGame('memory')">En Yüksek Skorlar</button>
<button class="btn" onclick="window.submitScoreUI('memory')">Bitir ve Skor Gönder</button>
<button class="btn tab" data-target="hafiza">Geri</button>
</div>
</section>

<section id="leaderboard" class="panel hidden">
<h2 id="lb-title">Leaderboard</h2>
<div id="lb-list" class="card" style="padding:0.6rem">Yükleniyor...</div>
<div class="small muted" id="lb-source-note" style="margin-top:0.6rem">Kaynak:</div>
<div style="margin-top:0.6rem"><button class="btn tab" data-target="home">Kapat</button></div>
</section>
</main>

<footer class="site-footer">
<div class="container">
<p>© <span id="year"></span> Matbilzek — FF Eğitsel Matematik Oyunları</p>
<p class="muted small">Sınırsız Süre • 10 puan • 3 doğru = +15 bonus</p>
</div>
</footer>

<script>
document.getElementById('year').textContent = new Date().getFullYear();

if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('/sw.js').catch(() => {});
}
</script>

<script>
let currentTimer = null;

const gameInitFunctions = {
  addition: function() {
    let score = 0, combo = 0;
    const scoreEl = document.getElementById('add-score');
    scoreEl.textContent = score;


    if (typeof currentTimer !== 'undefined' && currentTimer) {
        clearInterval(currentTimer);
        currentTimer = null;
    }
    

    function gen() {
      // 3 basamaklı sayılar: 100-999
      const a = Math.floor(Math.random() * 900) + 100;
      const b = Math.floor(Math.random() * 900) + 100;
      const correct = a + b;  // Toplam en fazla 1998 olacak

      let opts = [correct];
      while (opts.length < 4) {
        // Yanlış şıkları doğru cevaba yakın üret (±50 civarı), negatif olmaması için kontrol
        let w = correct + Math.floor(Math.random() * 101) - 50;  // -50 ile +50 arası
        if (w > 0 && !opts.includes(w) && w !== correct) {
          opts.push(w);
        }
      }
      opts.sort(() => Math.random() - 0.5);

      document.getElementById('add-question').textContent = `${a} + ${b} = ?`;
      const ans = document.getElementById('add-answers');
      ans.innerHTML = '';

      opts.forEach(o => {
        const btn = document.createElement('button');
        btn.className = 'answer-btn';
        btn.textContent = o;
        btn.onclick = () => {
          if (btn.disabled) return;
          document.querySelectorAll('#add-answers button').forEach(b => b.disabled = true);
          btn.classList.add(o === correct ? 'correct' : 'wrong');

          if (o === correct) {
            score += 10;
            combo++;
            if (combo % 3 === 0) score += 15;
          } else {
            combo = 0;
          }
          scoreEl.textContent = score;

          setTimeout(() => {
            document.querySelectorAll('#add-answers button').forEach(b => {
              b.disabled = false;
              b.classList.remove('correct', 'wrong');
            });
            gen();
          }, 800);
        };
        ans.appendChild(btn);
      });
    }
    gen();
  },

  subtraction: function() {
    let score = 0, combo = 0;
    const scoreEl = document.getElementById('sub-score');
    
    scoreEl.textContent = score;
   
 if (typeof currentTimer !== 'undefined' && currentTimer) {
        clearInterval(currentTimer);
        currentTimer = null;
    }
    

    function gen() {
      // 3 basamaklı büyük sayı
      const a = Math.floor(Math.random() * 900) + 100; // 100-999
      // b, a'dan küçük veya eşit olsun (sonuç negatif olmasın)
      const b = Math.floor(Math.random() * a);
      const correct = a - b;

      let opts = [correct];
      while (opts.length < 4) {
        // Yanlış şıkları doğru cevaba yakın üret (±50 civarı)
        let w = correct + Math.floor(Math.random() * 101) - 50; // -50 ile +50 arası
        if (w >= 0 && !opts.includes(w) && w !== correct) {
          opts.push(w);
        }
      }
      opts.sort(() => Math.random() - 0.5);

      document.getElementById('sub-question').textContent = `${a} - ${b} = ?`;
      const ans = document.getElementById('sub-answers');
      ans.innerHTML = '';

      opts.forEach(o => {
        const btn = document.createElement('button');
        btn.className = 'answer-btn';
        btn.textContent = o;
        btn.onclick = () => {
          if (btn.disabled) return;
          document.querySelectorAll('#sub-answers button').forEach(b => b.disabled = true);
          btn.classList.add(o === correct ? 'correct' : 'wrong');

          if (o === correct) {
            score += 10;
            combo++;
            if (combo % 3 === 0) score += 15;
          } else {
            combo = 0;
          }
          scoreEl.textContent = score;

          setTimeout(() => {
            document.querySelectorAll('#sub-answers button').forEach(b => {
              b.disabled = false;
              b.classList.remove('correct', 'wrong');
            });
            gen();
          }, 800);
        };
        ans.appendChild(btn);
      });
    }
    gen();
  },

              
  multiplication: function() {
    let score = 0, combo = 0;
    const scoreEl = document.getElementById('mul-score');
    
    scoreEl.textContent = score;
    

    if (typeof currentTimer !== 'undefined' && currentTimer) {
        clearInterval(currentTimer);
        currentTimer = null;
    }

    function gen() {
      // Rastgele çarpma tipi seçiyoruz
      const type = Math.floor(Math.random() * 5); // 0-4 arası 5 farklı tip

      let a, b;

      if (type === 0) {
        // 3 basamaklı × 1 basamaklı
        a = Math.floor(Math.random() * 900) + 100; // 100-999
        b = Math.floor(Math.random() * 9) + 1;     // 1-9
      } else if (type === 1) {
        // 3 basamaklı × 2 basamaklı
        a = Math.floor(Math.random() * 900) + 100; // 100-999
        b = Math.floor(Math.random() * 90) + 10;   // 10-99
      } else if (type === 2) {
        // 3 basamaklı × 3 basamaklı
        a = Math.floor(Math.random() * 900) + 100; // 100-999
        b = Math.floor(Math.random() * 900) + 100; // 100-999
      } else if (type === 3) {
        // 2 basamaklı × 1 basamaklı
        a = Math.floor(Math.random() * 90) + 10;   // 10-99
        b = Math.floor(Math.random() * 9) + 1;     // 1-9
      } else {
        // 2 basamaklı × 2 basamaklı
        a = Math.floor(Math.random() * 90) + 10;   // 10-99
        b = Math.floor(Math.random() * 90) + 10;   // 10-99
      }

      const correct = a * b;

      // Yanlış şıklar: doğru cevaba yakın değerler üretelim
      let opts = [correct];
      while (opts.length < 4) {
        // Doğru cevabın yaklaşık ±15% farkla yanlış şıklar
        const deviation = Math.floor(correct * 0.15);
        let w = correct + Math.floor(Math.random() * (deviation * 2 + 1)) - deviation;

        // Negatif olmasın ve zaten listede olmasın
        if (w > 0 && !opts.includes(w)) {
          opts.push(w);
        }
      }

      opts.sort(() => Math.random() - 0.5);

      document.getElementById('mul-question').textContent = `${a} × ${b} = ?`;
      const ans = document.getElementById('mul-answers');
      ans.innerHTML = '';

      opts.forEach(o => {
        const btn = document.createElement('button');
        btn.className = 'answer-btn';
        btn.textContent = o;
        btn.onclick = () => {
          if (btn.disabled) return;
          document.querySelectorAll('#mul-answers button').forEach(b => b.disabled = true);
          btn.classList.add(o === correct ? 'correct' : 'wrong');

          if (o === correct) {
            score += 10;
            combo++;
            if (combo % 3 === 0) score += 15;
          } else {
            combo = 0;
          }
          scoreEl.textContent = score;

          setTimeout(() => {
            document.querySelectorAll('#mul-answers button').forEach(b => {
              b.disabled = false;
              b.classList.remove('correct', 'wrong');
            });
            gen();
          }, 800);
        };
        ans.appendChild(btn);
      });
    }
    gen();
  },


division: function() {
    let score = 0, combo = 0;
    const scoreEl = document.getElementById('div-score');
    
    scoreEl.textContent = score;
    

     if (typeof currentTimer !== 'undefined' && currentTimer) {
        clearInterval(currentTimer);
        currentTimer = null;
    }

    function gen() {
      // Rastgele bölen (divisor): 2 veya 3 basamaklı, 11-99 arası (10 ve 5 ile kolay bölünebilirlik için tercihli)
      const digitCount = Math.random() < 0.7 ? 2 : 3; // %70 2 basamaklı, %30 3 basamaklı
      let divisor;
      if (digitCount === 2) {
        // 2 basamaklı: 11-99, özellikle 10, 20, 25, 30, 40, 50, 60, 75, 80 gibi kolay olanlar ağırlıklı
        const easyDivisors = [10, 12, 15, 20, 25, 30, 40, 50, 60, 75, 80, 90];
        divisor = easyDivisors[Math.floor(Math.random() * easyDivisors.length)];
      } else {
        // 3 basamaklı nadir, ama mümkün (örneğin 100, 125, 150 gibi)
        const easyBig = [100, 125, 150, 200, 250, 300, 400, 500];
        divisor = easyBig[Math.floor(Math.random() * easyBig.length)];
      }

      // Bölüm (quotient): 5-50 arası (sonuç mantıklı ve zihinden hesaplanabilir olsun)
      const quotient = Math.floor(Math.random() * 46) + 5; // 5-50

      // Bölünen sayı: divisor * quotient → tam bölünüyor ve genellikle 0 ile bitiyor
      const dividend = divisor * quotient;

      const correct = quotient;

      // Yanlış şıklar: doğru cevaba yakın (±10 civarı), pozitif ve tekrarsız
      let opts = [correct];
      while (opts.length < 4) {
        let w = correct + Math.floor(Math.random() * 21) - 10; // -10 ile +10 arası
        if (w > 0 && !opts.includes(w)) {
          opts.push(w);
        }
      }

      opts.sort(() => Math.random() - 0.5);

      document.getElementById('div-question').textContent = `${dividend} ÷ ${divisor} = ?`;
      const ans = document.getElementById('div-answers');
      ans.innerHTML = '';

      opts.forEach(o => {
        const btn = document.createElement('button');
        btn.className = 'answer-btn';
        btn.textContent = o;
        btn.onclick = () => {
          if (btn.disabled) return;
          document.querySelectorAll('#div-answers button').forEach(b => b.disabled = true);
          btn.classList.add(o === correct ? 'correct' : 'wrong');

          if (o === correct) {
            score += 10;
            combo++;
            if (combo % 3 === 0) score += 15;
          } else {
            combo = 0;
          }
          scoreEl.textContent = score;

          setTimeout(() => {
            document.querySelectorAll('#div-answers button').forEach(b => {
              b.disabled = false;
              b.classList.remove('correct', 'wrong');
            });
            gen();
          }, 800);
        };
        ans.appendChild(btn);
      });
    }
    gen();
  },


  geometryGame: function() {
    let score = 0, combo = 0;
    const scoreEl = document.getElementById('geo-score');
    const questionEl = document.getElementById('geo-question');
    const ansContainer = document.getElementById('geo-answers');

    scoreEl.textContent = score;

    if (typeof currentTimer !== 'undefined' && currentTimer) {
        clearInterval(currentTimer);
        currentTimer = null;
    }

    const shapes = [
      { name: "Nokta", draw: "." },
      { name: "Doğru", draw: "⟷" },
      { name: "Doğru Parçası", draw: "—" },
      { name: "Işın", draw: "→" },
      { name: "Açı", draw: "∠" },
      { name: "Çember", draw: "O" },
      { name: "Dikme", draw: "⊥" }
    ];

    function gen() {
      const correctShape = shapes[Math.floor(Math.random() * shapes.length)];
      questionEl.textContent = correctShape.draw;
      
      let opts = [correctShape.name];
      while (opts.length < 4) {
        let r = shapes[Math.floor(Math.random() * shapes.length)].name;
        if (!opts.includes(r)) opts.push(r);
      }
      opts.sort(() => Math.random() - 0.5);

      ansContainer.innerHTML = '';
      opts.forEach(o => {
        const btn = document.createElement('button');
        btn.className = 'answer-btn';
        btn.textContent = o;
        btn.onclick = () => {
          if (btn.disabled) return;
          document.querySelectorAll('#geo-answers button').forEach(b => b.disabled = true);
          
          if (o === correctShape.name) {
            btn.classList.add('correct');
            score += 10;
            combo++;
            if (combo % 3 === 0) score += 15;
          } else {
            btn.classList.add('wrong');
            combo = 0;
          }
          scoreEl.textContent = score;

          setTimeout(() => {
            gen();
          }, 600);
        };
        ansContainer.appendChild(btn);
      });
    }
    gen();
},


  angleGame: function() {
    let score = 0, combo = 0;
    const scoreEl = document.getElementById('angle-score');
    const ansContainer = document.getElementById('angle-answers');
    const anglePath = document.getElementById('angle-path');

    scoreEl.textContent = score;

    if (typeof currentTimer !== 'undefined' && currentTimer) {
        clearInterval(currentTimer);
        currentTimer = null;
    }

    function drawAngle(degree) {
        const cx = 100; // Merkez X
        const cy = 150; // Merkez Y (Tabanda)
        const r = 80;   // Kol uzunluğu
        
        // İlk kol her zaman yatay (sağa doğru)
        const x1 = cx + r;
        const y1 = cy;
        
        // İkinci kol açığa göre hesaplanır (Radyan cinsinden)
        const rad = (degree * Math.PI) / 180;
        const x2 = cx + r * Math.cos(-rad); // SVG'de Y aşağı artar, bu yüzden -rad
        const y2 = cy + r * Math.sin(-rad);
        
        // SVG Path oluşturma: Merkeze git -> İlk kola git -> Merkeze dön -> İkinci kola git
        anglePath.setAttribute('d', `M ${x1} ${y1} L ${cx} ${cy} L ${x2} ${y2}`);
    }

    function gen() {
        // 10 ile 170 derece arası rastgele bir açı seç (5'in katları olması kolaylık sağlar)
        const correctDegree = (Math.floor(Math.random() * 33) + 2) * 5; 
        drawAngle(correctDegree);

        // Şıkları oluştur
        let opts = [correctDegree];
        while (opts.length < 4) {
            let offset = (Math.floor(Math.random() * 5) - 2) * 10; // ±10 veya ±20 fark
            let wrong = correctDegree + (offset === 0 ? 15 : offset);
            if (wrong > 0 && wrong <= 180 && !opts.includes(wrong)) {
                opts.push(wrong);
            }
        }
        opts.sort(() => Math.random() - 0.5);

        ansContainer.innerHTML = '';
        opts.forEach(o => {
            const btn = document.createElement('button');
            btn.className = 'answer-btn';
            btn.textContent = o + "°";
            btn.onclick = () => {
                if (btn.disabled) return;
                document.querySelectorAll('#angle-answers button').forEach(b => b.disabled = true);
                
                if (o === correctDegree) {
                    btn.classList.add('correct');
                    score += 15; // Açı ölçme daha zor olduğu için puanı artırdık
                    combo++;
                    if (combo % 3 === 0) score += 20;
                } else {
                    btn.classList.add('wrong');
                    combo = 0;
                }
                scoreEl.textContent = score;

                setTimeout(() => {
                    gen();
                }, 800);
            };
            ansContainer.appendChild(btn);
        });
    }

    gen();
},


triangleCircleGame: function() {
    let score = 0, combo = 0;
    const scoreEl = document.getElementById('tri-score');
    const ansContainer = document.getElementById('tri-answers');
    const svg = document.getElementById('tri-svg');

    scoreEl.textContent = score;

    // Varsa eski zamanlayıcıyı durdur
    if (typeof currentTimer !== 'undefined' && currentTimer) {
        clearInterval(currentTimer);
        currentTimer = null;
    }

    function gen() {
        const types = ["Eşkenar Üçgen", "İkizkenar Üçgen", "Çeşitkenar Üçgen"];
        const targetType = types[Math.floor(Math.random() * types.length)];
        
        let r1, r2, d; // r1: 1.çember, r2: 2.çember, d: merkezler arası mesafe
        
        // Üçgen eşitsizliği ve tiplerine göre değer belirleme
        if (targetType === "Eşkenar Üçgen") {
            r1 = r2 = d = 70; // Tüm kenarlar eşit
        } else if (targetType === "İkizkenar Üçgen") {
            r1 = r2 = 80; d = 60; // İki yarıçap eşit, merkez mesafesi farklı
        } else {
            r1 = 90; r2 = 60; d = 70; // Tüm kenarlar farklı
        }

        // Çizim koordinatları
        const c1x = 70, c1y = 100;
        const c2x = c1x + d, c2y = 100;

        // Kesişim noktasını bulma (Trigonometrik hesaplama)
        const cosA = (r1*r1 + d*d - r2*r2) / (2 * r1 * d);
        const sinA = Math.sqrt(1 - cosA * cosA);
        const kx = c1x + r1 * cosA;
        const ky = c1y - r1 * sinA;

        // SVG İçeriğini Oluştur
        svg.innerHTML = `
            <circle cx="${c1x}" cy="${c1y}" r="${r1}" fill="none" stroke="#add8e6" stroke-width="2" />
            <circle cx="${c2x}" cy="${c2y}" r="${r2}" fill="none" stroke="#ffb6c1" stroke-width="2" />
            <path d="M ${c1x} ${c1y} L ${c2x} ${c2y} L ${kx} ${ky} Z" fill="rgba(255,255,0,0.2)" stroke="black" stroke-width="3" />
            <circle cx="${c1x}" cy="${c1y}" r="4" fill="blue" />
            <circle cx="${c2x}" cy="${c2y}" r="4" fill="red" />
            <circle cx="${kx}" cy="${ky}" r="4" fill="black" />
        `;

        // Şıkları oluştur
        ansContainer.innerHTML = '';
        types.forEach(o => {
            const btn = document.createElement('button');
            btn.className = 'answer-btn';
            btn.textContent = o;
            btn.onclick = () => {
                if (btn.disabled) return;
                document.querySelectorAll('#tri-answers button').forEach(b => b.disabled = true);
                
                if (o === targetType) {
                    btn.classList.add('correct');
                    score += 20;
                    combo++;
                } else {
                    btn.classList.add('wrong');
                    combo = 0;
                }
                scoreEl.textContent = score;
                setTimeout(gen, 800);
            };
            ansContainer.appendChild(btn);
        });
    }

    gen();
},


numberGame: function() {
    let score = 0, combo = 0;
    // ID'leri HTML ile eşleştiriyoruz
    const scoreEl = document.getElementById('num-score');
    const displayEl = document.getElementById('num-display');
    const questionTextEl = document.getElementById('num-question-text');
    const ansContainer = document.getElementById('num-answers');

    if (scoreEl) scoreEl.textContent = score;

    // Timer kontrolü: Diğer oyunları bozmamak için sadece varsa temizle
    if (typeof currentTimer !== 'undefined' && currentTimer) {
        clearInterval(currentTimer);
        currentTimer = null;
    }

    const basamaklar = [
        "Birler Basamağı", "Onlar Basamağı", "Yüzler Basamağı",
        "Binler Basamağı", "On Binler Basamağı", "Yüz Binler Basamağı",
        "Milyonlar Basamağı", "On Milyonlar Basamağı", "Yüz Milyonlar Basamağı"
    ];

    // Rakamları birbirinden farklı sayı üretme
    function generateUniqueDigitNumber(length) {
        let pool = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9];
        let res = [];
        let firstIdx = Math.floor(Math.random() * 9) + 1;
        res.push(pool[firstIdx]);
        pool.splice(firstIdx, 1);
        pool.sort(() => Math.random() - 0.5);
        for(let i = 0; i < length - 1; i++) res.push(pool[i]);
        return parseInt(res.join(''));
    }

    // Sayıyı yazıya çevirme
    function sayiyiOku(n) {
        const birler = ["", "bir", "iki", "üç", "dört", "beş", "altı", "yedi", "sekiz", "dokuz"];
        const onlar = ["", "on", "yirmi", "otuz", "kırk", "elli", "altmış", "yetmiş", "seksen", "doksan"];
        const binler = ["", "bin", "milyon"];
        let sonuc = "";
        let grupSayisi = 0;
        let tempN = n;
        while (tempN > 0) {
            let uc = tempN % 1000;
            if (uc > 0) {
                let s = "";
                let y = Math.floor(uc / 100);
                let o = Math.floor((uc % 100) / 10);
                let b = uc % 10;
                if (y > 0) s += (y === 1 ? "" : birler[y]) + "yüz";
                if (o > 0) s += onlar[o];
                if (b > 0) {
                    if (!(grupSayisi === 1 && b === 1 && y === 0 && o === 0)) s += birler[b];
                }
                sonuc = s + binler[grupSayisi] + " " + sonuc;
            }
            tempN = Math.floor(tempN / 1000);
            grupSayisi++;
        }
        return sonuc.trim() || "sıfır";
    }

    const gen = () => {
        const len = Math.floor(Math.random() * 4) + 6; // 6-9 basamak
        const sayi = generateUniqueDigitNumber(len);
        const soruTipi = Math.floor(Math.random() * 2); 
        let correct = "";
        let options = [];

        if (displayEl) displayEl.textContent = sayi.toLocaleString('tr-TR');

        if (soruTipi === 0) {
            if (questionTextEl) questionTextEl.textContent = "Bu sayının okunuşu hangisidir?";
            correct = sayiyiOku(sayi);
            options = [correct];
            while(options.length < 4) {
                let yanlis = sayiyiOku(generateUniqueDigitNumber(len));
                if(!options.includes(yanlis)) options.push(yanlis);
            }
        } else {
            const idx = Math.floor(Math.random() * len);
            const rakam = String(sayi).split('').reverse()[idx];
            if (questionTextEl) questionTextEl.innerHTML = `<span style="color:blue; font-size:24px;">${rakam}</span> rakamı hangi basamaktadır?`;
            correct = basamaklar[idx];
            options = [correct];
            while(options.length < 4) {
                let yanlis = basamaklar[Math.floor(Math.random() * 9)];
                if(!options.includes(yanlis)) options.push(yanlis);
            }
        }

        options.sort(() => Math.random() - 0.5);
        if (ansContainer) {
            ansContainer.innerHTML = '';
            options.forEach(opt => {
                const btn = document.createElement('button');
                btn.className = 'answer-btn';
                btn.textContent = opt;
                btn.onclick = () => {
                    if (btn.disabled) return;
                    document.querySelectorAll('#num-answers button').forEach(b => b.disabled = true);
                    if (opt === correct) {
                        btn.classList.add('correct');
                        score += 10;
                    } else {
                        btn.classList.add('wrong');
                    }
                    if (scoreEl) scoreEl.textContent = score;
                    setTimeout(gen, 800);
                };
                ansContainer.appendChild(btn);
            });
        }
    };

    gen();
},
  

problemGame: function() {
    let score = 0;
    const scoreEl = document.getElementById('prob-score');
    const probTextEl = document.getElementById('prob-text');
    const ansContainer = document.getElementById('prob-answers');

    if (scoreEl) scoreEl.textContent = score;

    if (typeof currentTimer !== 'undefined' && currentTimer) {
        clearInterval(currentTimer);
        currentTimer = null;
    }

    const problemTemplates = [
        { text: (a, b, c) => `Bir çiftçi bahçesinden ${a} kg elma, elmalardan ${b} kg fazla armut toplamıştır. Toplam kaç kg meyve toplamıştır?`, solve: (a, b, c) => a + (a + b) },
        { text: (a, b, c) => `Bir sinema salonunda ${a} sıra ve her sırada ${b} koltuk vardır. Bir gösterimde ${c} koltuk boş kaldığına göre kaç bilet satılmıştır?`, solve: (a, b, c) => (a * b) - c, constraint: (a, b, c) => (a * b) > c },
        { text: (a, b, c) => `Kumbarasında ${a} TL olan Mert, her gün ${b} TL biriktiriyor. ${c} gün sonra toplam kaç TL'si olur?`, solve: (a, b, c) => a + (b * c) },
        { text: (a, b, c) => `Bir terzi ${a} metre kumaşın ${b} metresiyle ceket dikiyor. Kalan kumaşla her biri ${c} metre olan kaç tane etek dikebilir?`, solve: (a, b, c) => (a - b) / c, constraint: (a, b, c) => (a > b) && ((a - b) % c === 0) },
        { text: (a, b, c) => `Bir bakkal tanesi ${a} TL olan ekmeklerden ${b} tane satıp, kazandığı parayla tanesi ${c} TL olan sütlerden kaç tane alabilir?`, solve: (a, b, c) => (a * b) / c, constraint: (a, b, c) => (a * b) % c === 0 },
        { text: (a, b, c) => `Bir sporcu sabah ${a} metre, akşam sabahkinden ${b} metre fazla koşmuştur. Bu sporcu toplam kaç metre koşmuştur?`, solve: (a, b, c) => a + (a + b) },
        { text: (a, b, c) => `Bir kırtasiyeci ${a} kalemlik seti ${b} TL'ye alıp, tanesini ${c} TL'ye satıyor. Tüm seti satınca kaç TL kâr eder?`, solve: (a, b, c) => (a * c) - b, constraint: (a, b, c) => (a * c) > b },
        { text: (a, b, c) => `${a} katlı bir binanın her katında ${b} daire vardır. Her dairede ${c} kişi yaşadığına göre binada toplam kaç kişi vardır?`, solve: (a, b, c) => a * b * c },
        { text: (a, b, c) => `Bir araç ${a} km'lik yolun ${b} km'sini gitmiştir. Kalan yolu saatte ${c} km hızla kaç saatte gider?`, solve: (a, b, c) => (a - b) / c, constraint: (a, b, c) => (a > b) && ((a - b) % c === 0) },
        { text: (a, b, c) => `Zeynep ${a} yaşındadır. Annesinin yaşı Zeynep'in yaşının ${b} katından ${c} fazladır. Annesi kaç yaşındadır?`, solve: (a, b, c) => (a * b) + c },
        { text: (a, b, c) => `Bir miktar fındık ${a} çocuğa ${b}'şer tane dağıtılınca ${c} fındık artıyor. Başlangıçta kaç fındık vardı?`, solve: (a, b, c) => (a * b) + c },
        { text: (a, b, c) => `Bir su deposunda ${a} litre su vardır. Dakikada ${b} litre su akıtan bir musluk ${c} dakika açık kalırsa depoda kaç litre su kalır?`, solve: (a, b, c) => a - (b * c), constraint: (a, b, c) => a > (b * c) },
        { text: (a, b, c) => `Bir manav tanesi ${a} TL olan karpuzlardan ${b} tane alıp toplam ${c} TL kâr etmek istiyor. Bir karpuzu kaç TL'ye satmalıdır?`, solve: (a, b, c) => ((a * b) + c) / b, constraint: (a, b, c) => ((a * b) + c) % b === 0 },
        { text: (a, b, c) => `Okul gezisine ${a} öğrenci ve ${b} öğretmen katılacaktır. Yolcu kapasitesi ${c} kişi olan bir otobüsten en az kaç tane gereklidir?`, solve: (a, b, c) => (a + b) / c, constraint: (a, b, c) => (a + b) % c === 0 },
        { text: (a, b, c) => `Bir aşçı ${a} gram unun yarısını kullandıktan sonra ${b} gram daha un ekliyor. Son durumda kaç gram un vardır?`, solve: (a, b, c) => (a / 2) + b, constraint: (a, b, c) => a % 2 === 0 },
        { text: (a, b, c) => `Bir otoparkta ${a} araba vardır. Arabaların her birinde ${b} tekerlek olduğuna göre, otoparka ${c} tane daha araba gelirse toplam tekerlek sayısı kaç olur?`, solve: (a, b, c) => (a + c) * b },
        { text: (a, b, c) => `Günde ${a} sayfa kitap okuyan birisi, ${b} sayfalık bir kitabı bitirmesine ${c} sayfa kala kaç gün kitap okumuştur?`, solve: (a, b, c) => (b - c) / a, constraint: (a, b, c) => (b > c) && ((b - c) % a === 0) },
        { text: (a, b, c) => `Bir teknoloji mağazasında ${a} TL'lik tableti ${b} TL peşinat ve kalanını ${c} taksitle alan birinin bir taksiti kaç TL'dir?`, solve: (a, b, c) => (a - b) / c, constraint: (a, b, c) => (a > b) && ((a - b) % c === 0) },
        { text: (a, b, c) => `Tanesi ${a} TL olan kalemlerden ${b} tane, tanesi ${c} TL olan silgilerden ${b} tane alan biri toplam kaç TL öder?`, solve: (a, b, c) => (a + c) * b },
        { text: (a, b, c) => `Bir kutuda ${a} adet çikolata vardır. ${b} kutu çikolata alan bir öğretmen, bunları ${c} öğrencisine eşit dağıtırsa her öğrenciye kaç çikolata düşer?`, solve: (a, b, c) => (a * b) / c, constraint: (a, b, c) => (a * b) % c === 0 }
    ];

    const gen = () => {
        let template = problemTemplates[Math.floor(Math.random() * problemTemplates.length)];
        let a, b, c, attempts = 0;

        // Sayıları üret ve kısıtlamalara uyana kadar dene (Max 100 deneme)
        do {
            a = Math.floor(Math.random() * 50) + 5;
            b = Math.floor(Math.random() * 50) + 5;
            c = Math.floor(Math.random() * 20) + 2;
            attempts++;
        } while (template.constraint && !template.constraint(a, b, c) && attempts < 100);

        const correctAns = template.solve(a, b, c);
        probTextEl.textContent = template.text(a, b, c);

        let opts = [correctAns];
        while (opts.length < 4) {
            let offset = Math.floor(Math.random() * 15) + 1;
            let wrong = Math.random() > 0.5 ? correctAns + offset : correctAns - offset;
            if (wrong > 0 && !opts.includes(wrong)) opts.push(wrong);
        }
        opts.sort(() => Math.random() - 0.5);

        ansContainer.innerHTML = '';
        opts.forEach(o => {
            const btn = document.createElement('button');
            btn.className = 'answer-btn';
            btn.textContent = o;
            btn.onclick = () => {
                if (btn.disabled) return;
                document.querySelectorAll('#prob-answers button').forEach(b => b.disabled = true);
                if (o === correctAns) {
                    btn.classList.add('correct');
                    score += 20;
                } else {
                    btn.classList.add('wrong');
                }
                scoreEl.textContent = score;
                setTimeout(gen, 1000);
            };
            ansContainer.appendChild(btn);
        });
    };

    gen();
},


rectAreaPerimeterGame: function() {
    let score = 0;
    const scoreEl = document.getElementById('rect-score');
    const questionEl = document.getElementById('rect-question');
    const ansContainer = document.getElementById('rect-answers');
    const rectShape = document.getElementById('rect-shape');
    const labelTop = document.getElementById('rect-label-top');
    const labelSide = document.getElementById('rect-label-side');

    if (scoreEl) scoreEl.textContent = score;

    if (typeof currentTimer !== 'undefined' && currentTimer) {
        clearInterval(currentTimer);
        currentTimer = null;
    }

    function gen() {
        // Rastgele kısa ve uzun kenar (Tam sayı olması için)
        let a = Math.floor(Math.random() * 8) + 3; // Kısa kenar 3-10
        let b = a + (Math.floor(Math.random() * 7) + 2); // Uzun kenar a+2...a+8
        
        const alan = a * b;
        const cevre = 2 * (a + b);
        
        // Soru tipini seç: 0 = Çevreden Alan bul, 1 = Alandan Çevre bul
        const soruTipi = Math.floor(Math.random() * 2);
        let correctAns;
        
        // Görseli güncelle (SVG ölçekleme)
        const scale = 10;
        const w = b * scale;
        const h = a * scale;
        rectShape.setAttribute("width", w);
        rectShape.setAttribute("height", h);
        rectShape.setAttribute("x", (200 - w) / 2);
        rectShape.setAttribute("y", (150 - h) / 2);
        
        labelTop.setAttribute("x", 100);
        labelTop.setAttribute("y", (150 - h) / 2 - 10);
        labelSide.setAttribute("x", (200 - w) / 2 - 10);
        labelSide.setAttribute("y", 75);

        if (soruTipi === 0) {
            // Çevresi verilip Alanı istenecek
            // Basitleştirmek için kenarlardan birini veriyoruz
            questionEl.innerHTML = `Çevresi <b>${cevre} cm</b> olan ve bir kenarı <b>${b} cm</b> olan dikdörtgenin <u>alanı</u> kaç cm²'dir?`;
            correctAns = alan;
            labelTop.textContent = b + " cm";
            labelSide.textContent = "?";
        } else {
            // Alanı verilip Çevresi istenecek
            questionEl.innerHTML = `Alanı <b>${alan} cm²</b> olan ve bir kenarı <b>${a} cm</b> olan dikdörtgenin <u>çevresi</u> kaç cm'dir?`;
            correctAns = cevre;
            labelTop.textContent = "?";
            labelSide.textContent = a + " cm";
        }

        // Şıkları oluştur
        let opts = [correctAns];
        while (opts.length < 4) {
            let offset = (Math.floor(Math.random() * 5) + 1) * 2;
            let wrong = Math.random() > 0.5 ? correctAns + offset : correctAns - offset;
            if (wrong > 0 && !opts.includes(wrong)) opts.push(wrong);
        }
        opts.sort(() => Math.random() - 0.5);

        ansContainer.innerHTML = '';
        opts.forEach(o => {
            const btn = document.createElement('button');
            btn.className = 'answer-btn';
            btn.textContent = o + (soruTipi === 0 ? " cm²" : " cm");
            btn.onclick = () => {
                if (btn.disabled) return;
                document.querySelectorAll('#rect-answers button').forEach(b => b.disabled = true);
                if (o === correctAns) {
                    btn.classList.add('correct');
                    score += 20;
                } else {
                    btn.classList.add('wrong');
                }
                if (scoreEl) scoreEl.textContent = score;
                setTimeout(gen, 1000);
            };
            ansContainer.appendChild(btn);
        });
    }

    gen();
},

  
  
  primes: function() {
    let score = 0, combo = 0;
    const scoreEl = document.getElementById('prime-score');
    const timeEl = document.getElementById('prime-time');
    scoreEl.textContent = score;
 
     if (typeof currentTimer !== 'undefined' && currentTimer) {
        clearInterval(currentTimer);
        currentTimer = null;
    }

    const isPrime = n => {
      if (n <= 1) return false;
      for (let i = 2; i <= Math.sqrt(n); i++) if (n % i === 0) return false;
      return true;
    };

    function gen() {
      const num = Math.floor(Math.random() * 99) + 2;
      const correct = isPrime(num) ? 'Evet' : 'Hayır';
      document.getElementById('prime-question').textContent = `${num} asal sayı mı?`;
      const ans = document.getElementById('prime-answers'); ans.innerHTML = '';
      ['Evet', 'Hayır'].forEach(o => {
        const btn = document.createElement('button');
        btn.className = 'answer-btn';
        btn.textContent = o;
        btn.onclick = () => {
          if (btn.disabled) return;
          document.querySelectorAll('#prime-answers button').forEach(b => b.disabled = true);
          btn.classList.add(o === correct ? 'correct' : 'wrong');
          if (o === correct) {
            score += 10; combo++;
            if (combo % 3 === 0) score += 15;
          } else combo = 0;
          scoreEl.textContent = score;
          setTimeout(() => {
            document.querySelectorAll('#prime-answers button').forEach(b => {
              b.disabled = false; b.classList.remove('correct', 'wrong');
            });
            gen();
          }, 800);
        };
        ans.appendChild(btn);
      });
    }
    gen();
  },

  factors: function() {
    let score = 0, combo = 0;
    const scoreEl = document.getElementById('fac-score');
   
    scoreEl.textContent = score;

     if (typeof currentTimer !== 'undefined' && currentTimer) {
        clearInterval(currentTimer);
        currentTimer = null;
    }

    const getFactorsStr = n => {
      let f = [];
      for (let i = 1; i <= n; i++) if (n % i === 0) f.push(i);
      return f.join(', ');
    };

    function gen() {
      const num = Math.floor(Math.random() * 50) + 10;
      const correct = getFactorsStr(num);
      let opts = [correct];
      while (opts.length < 4) {
        const wrongNum = num + Math.floor(Math.random() * 10 - 5);
        const w = wrongNum > 1 ? getFactorsStr(wrongNum) : '1';
        if (!opts.includes(w)) opts.push(w);
      }
      opts.sort(() => Math.random() - 0.5);
      document.getElementById('fac-question').textContent = `${num} sayısının çarpanları?`;
      const ans = document.getElementById('fac-answers'); ans.innerHTML = '';
      opts.forEach(o => {
        const btn = document.createElement('button');
        btn.className = 'answer-btn';
        btn.textContent = o;
        btn.onclick = () => {
          if (btn.disabled) return;
          document.querySelectorAll('#fac-answers button').forEach(b => b.disabled = true);
          btn.classList.add(o === correct ? 'correct' : 'wrong');
          if (o === correct) {
            score += 10; combo++;
            if (combo % 3 === 0) score += 15;
          } else combo = 0;
          scoreEl.textContent = score;
          setTimeout(() => {
            document.querySelectorAll('#fac-answers button').forEach(b => {
              b.disabled = false; b.classList.remove('correct', 'wrong');
            });
            gen();
          }, 800);
        };
        ans.appendChild(btn);
      });
    }
    gen();
  },

  gcdlcm: function() {
    let score = 0,  combo = 0;
    const scoreEl = document.getElementById('gcd-score');
    
    scoreEl.textContent = score;
  
     if (typeof currentTimer !== 'undefined' && currentTimer) {
        clearInterval(currentTimer);
        currentTimer = null;
    }

    const gcd = (a, b) => b === 0 ? a : gcd(b, a % b);
    const lcm = (a, b) => (a * b) / gcd(a, b);

    function gen() {
      const a = Math.floor(Math.random() * 30) + 5;
      const b = Math.floor(Math.random() * 30) + 5;
      const isGcd = Math.random() > 0.5;
      const correct = isGcd ? gcd(a, b) : lcm(a, b);
      let opts = [correct];
      while (opts.length < 4) {
        let w = correct + Math.floor(Math.random() * 11 - 5);
        if (w > 0 && !opts.includes(w)) opts.push(w);
      }
      opts.sort(() => Math.random() - 0.5);
      document.getElementById('gcd-question').textContent = `${a} ve ${b}'nin ${isGcd ? 'Ortak Böleni' : 'Ortak Katı'} nedir?`;
      const ans = document.getElementById('gcd-answers'); ans.innerHTML = '';
      opts.forEach(o => {
        const btn = document.createElement('button');
        btn.className = 'answer-btn';
        btn.textContent = o;
        btn.onclick = () => {
          if (btn.disabled) return;
          document.querySelectorAll('#gcd-answers button').forEach(b => b.disabled = true);
          btn.classList.add(o === correct ? 'correct' : 'wrong');
          if (o === correct) {
            score += 10; combo++;
            if (combo % 3 === 0) score += 15;
          } else combo = 0;
          scoreEl.textContent = score;
          setTimeout(() => {
            document.querySelectorAll('#gcd-answers button').forEach(b => {
              b.disabled = false; b.classList.remove('correct', 'wrong');
            });
            gen();
          }, 800);
        };
        ans.appendChild(btn);
      });
    }
    gen();
  },

  frac6: function() {
    let score = 0, combo = 0;
    const scoreEl = document.getElementById('frac-score');
    
    scoreEl.textContent = score;
   
    if (typeof currentTimer !== 'undefined' && currentTimer) {
        clearInterval(currentTimer);
        currentTimer = null;
    }

    function gen() {
      const pay = Math.floor(Math.random() * 10) + 1;
      const payda = Math.floor(Math.random() * 9) + 2;
      const carp = Math.floor(Math.random() * 5) + 2;
      const correct = `${pay * carp}/${payda * carp}`;
      let opts = [correct];
      while (opts.length < 4) {
        const wrongPay = pay * carp + Math.floor(Math.random() * 5 - 2);
        const w = `${wrongPay}/${payda * carp}`;
        if (!opts.includes(w)) opts.push(w);
      }
      opts.sort(() => Math.random() - 0.5);
      document.getElementById('frac-question').innerHTML = `${pay}/${payda} ile denk kesir?`;
      const ans = document.getElementById('frac-answers'); ans.innerHTML = '';
      opts.forEach(o => {
        const btn = document.createElement('button');
        btn.className = 'answer-btn';
        btn.innerHTML = o;
        btn.onclick = () => {
          if (btn.disabled) return;
          document.querySelectorAll('#frac-answers button').forEach(b => b.disabled = true);
          btn.classList.add(o === correct ? 'correct' : 'wrong');
          if (o === correct) {
            score += 10; combo++;
            if (combo % 3 === 0) score += 15;
          } else combo = 0;
          scoreEl.textContent = score;
          setTimeout(() => {
            document.querySelectorAll('#frac-answers button').forEach(b => {
              b.disabled = false; b.classList.remove('correct', 'wrong');
            });
            gen();
          }, 800);
        };
        ans.appendChild(btn);
      });
    }
    gen();
  },

  mixed: function() {
    let score = 0, combo = 0;
    const scoreEl = document.getElementById('mix-score');
    
    scoreEl.textContent = score;
    
     if (typeof currentTimer !== 'undefined' && currentTimer) {
        clearInterval(currentTimer);
        currentTimer = null;
    }

    function gen() {
      const tam = Math.floor(Math.random() * 6) + 1;
      const pay = Math.floor(Math.random() * 8) + 1;
      const payda = Math.floor(Math.random() * 7) + 3;
      const correct = `${tam * payda + pay}/${payda}`;
      let opts = [correct];
      while (opts.length < 4) {
        const wrongPay = tam * payda + pay + Math.floor(Math.random() * 9 - 4);
        const w = `${wrongPay}/${payda}`;
        if (!opts.includes(w)) opts.push(w);
      }
      opts.sort(() => Math.random() - 0.5);
      
      document.getElementById('mix-question').innerHTML = `<strong>${tam}</strong> tam <strong>${pay}</strong> bölü <strong>${payda}</strong> bileşik kesire çevir`;
      
      const ans = document.getElementById('mix-answers'); ans.innerHTML = '';
      
      opts.forEach(o => {
        const btn = document.createElement('button');
        btn.className = 'answer-btn';
        btn.innerHTML = o;
        btn.onclick = () => {
          if (btn.disabled) return;
          document.querySelectorAll('#mix-answers button').forEach(b => b.disabled = true);
          btn.classList.add(o === correct ? 'correct' : 'wrong');
          if (o === correct) {
            score += 10; combo++;
            if (combo % 3 === 0) score += 15;
          } else combo = 0;
          scoreEl.textContent = score;
          setTimeout(() => {
            document.querySelectorAll('#mix-answers button').forEach(b => {
              b.disabled = false; b.classList.remove('correct', 'wrong');
            });
            gen();
          }, 800);
        };
        ans.appendChild(btn);
      });
    }
    gen();
  },

  stats: function() {
  let score = 0, combo = 0;
  const scoreEl = document.getElementById('stat-score');
  
  scoreEl.textContent = score;
  
   if (typeof currentTimer !== 'undefined' && currentTimer) {
        clearInterval(currentTimer);
        currentTimer = null;
    }
    
  // Tepe değer bul: en çok tekrar eden sayılar (çoklu olabilir)
  const getModes = arr => {
    const freq = {};
    arr.forEach(n => freq[n] = (freq[n] || 0) + 1);
    let maxCount = 0;
    for (let num in freq) {
      if (freq[num] > maxCount) maxCount = freq[num];
    }
    // Maksimum tekrar sayısı 1 ise → Yok
    if (maxCount === 1) return ['Yok'];
    // En yüksek tekrara sahip tüm sayıları topla
    const modes = [];
    for (let num in freq) {
      if (freq[num] === maxCount) modes.push(num);
    }
    // Sıralı olsun diye sort yap
    return modes.sort((a, b) => a - b);
  };
  const mean = arr => (arr.reduce((a,b)=>a+b,0)/arr.length).toFixed(1);
  const median = arr => {
    const s = [...arr].sort((a,b)=>a-b);
    const m = Math.floor(s.length/2);
    return s.length % 2 === 0 ? ((s[m-1] + s[m]) / 2).toFixed(1) : s[m];
  };
  function gen() {
    // 5-8 tane doğal sayı
    const nums = Array.from({length: Math.floor(Math.random() * 4) + 5}, () => Math.floor(Math.random() * 20) + 1);
    const type = Math.floor(Math.random() * 3);
    let correct, qType;
    if (type === 0) {
      correct = mean(nums); // sayı veya x.x formatında string
      qType = 'Aritmetik Ortalama';
    } else if (type === 1) {
      correct = median(nums);
      qType = 'Ortanca';
    } else {
      const modes = getModes(nums);
      // Doğru cevap: "Yok" ya da "3 ve 5" gibi birleştirilmiş string
      correct = modes.length === 1 && modes[0] === 'Yok' ? 'Yok' : modes.join(' ve ');
      qType = 'Tepe Değer';
    }
    // Seçenekler oluştur
    let opts = [correct.toString()];
    while (opts.length < 4) {
      let w;
      if (qType === 'Tepe Değer') {
        // Tepe için mantıklı yanlış seçenekler
        if (Math.random() < 0.3 && !opts.includes('Yok')) {
          w = 'Yok';
        } else {
          // Rastgele bir sayı veya yanlış birleştirme
          const randomNum = Math.floor(Math.random() * 20) + 1;
          const another = Math.floor(Math.random() * 20) + 1;
          w = randomNum === another ? randomNum.toString() : `${randomNum} ve ${another}`;
        }
      } else {
        // Ortalama ve ortanca için
        w = (parseFloat(correct) + (Math.random() * 4 - 2)).toFixed(1);
      }
      if (!opts.includes(w)) opts.push(w);
    }
    opts.sort(() => Math.random() - 0.5);
    document.getElementById('stat-question').textContent =
      `${nums.join(', ')} sayılarının ${qType}?`;
    const ans = document.getElementById('stat-answers');
    ans.innerHTML = '';
    opts.forEach(o => {
      const btn = document.createElement('button');
      btn.className = 'answer-btn';
      btn.textContent = o;
      btn.onclick = () => {
        if (btn.disabled) return;
        document.querySelectorAll('#stat-answers button').forEach(b => b.disabled = true);
        // Doğru kontrol: string karşılaştırma
        const isCorrect = o === correct.toString();
        btn.classList.add(isCorrect ? 'correct' : 'wrong');
        if (isCorrect) {
          score += 10; combo++;
          if (combo % 3 === 0) score += 15;
        } else {
          combo = 0;
        }
        scoreEl.textContent = score;
        setTimeout(() => {
          document.querySelectorAll('#stat-answers button').forEach(b => {
            b.disabled = false;
            b.classList.remove('correct', 'wrong');
          });
          gen();
        }, 800);
      };
      ans.appendChild(btn);
    });
  }
  gen();
},


  integerGame: function() {
    let score = 0;
    const scoreEl = document.getElementById('int-score');
    const questionEl = document.getElementById('int-question');
    const ansContainer = document.getElementById('int-answers');

    if (scoreEl) scoreEl.textContent = score;

    // Önceki timerları temizle
    if (typeof currentTimer !== 'undefined' && currentTimer) {
        clearInterval(currentTimer);
        currentTimer = null;
    }

    function formatNum(n) {
        // Sayıyı parantez içinde işaretiyle gösterir: (-5) veya (+3)
        return n >= 0 ? `(+${n})` : `(${n})`;
    }

    function gen() {
        // -20 ile 20 arasında rastgele iki tam sayı
        const a = Math.floor(Math.random() * 41) - 20;
        const b = Math.floor(Math.random() * 41) - 20;
        
        // İşlem tipi: 0 = Toplama, 1 = Çıkarma
        const type = Math.floor(Math.random() * 2);
        const op = type === 0 ? "+" : "-";
        const correctAns = type === 0 ? a + b : a - b;

        // Soruyu ekrana yazdır
        questionEl.textContent = `${formatNum(a)} ${op} ${formatNum(b)} = ?`;

        // Şıkları oluştur (Öğrencinin yapabileceği işaret hatalarına göre çeldiriciler)
        let opts = new Set([correctAns]);
        
        // Olası yanlışlar: Ters işaretli sonuç, sadece sayıların toplamı vb.
        opts.add(-(correctAns)); 
        opts.add(a + b);
        opts.add(a - b);
        opts.add(Math.abs(a) + Math.abs(b));
        opts.add(Math.abs(a) - Math.abs(b));

        // Eğer set hala 4'ten azsa rastgele ekle
        let optArr = Array.from(opts);
        while (optArr.length < 4) {
            let r = correctAns + (Math.floor(Math.random() * 10) - 5);
            if (!optArr.includes(r)) optArr.push(r);
        }
        
        // Sadece ilk 4 şıkkı al ve karıştır
        optArr = optArr.slice(0, 4).sort(() => Math.random() - 0.5);

        ansContainer.innerHTML = '';
        optArr.forEach(o => {
            const btn = document.createElement('button');
            btn.className = 'answer-btn';
            btn.style.fontSize = "20px";
            btn.textContent = o > 0 ? `+${o}` : o;
            if(o === 0) btn.textContent = "0";

            btn.onclick = () => {
                if (btn.disabled) return;
                document.querySelectorAll('#int-answers button').forEach(b => b.disabled = true);
                
                if (o === correctAns) {
                    btn.classList.add('correct');
                    score += 15;
                } else {
                    btn.classList.add('wrong');
                }
                
                if (scoreEl) scoreEl.textContent = score;
                setTimeout(gen, 1000);
            };
            ansContainer.appendChild(btn);
        });
    }

    gen();
},
  

integerMulDivGame: function() {
    let score = 0;
    const scoreEl = document.getElementById('intmd-score');
    const questionEl = document.getElementById('intmd-question');
    const ansContainer = document.getElementById('intmd-answers');

    if (scoreEl) scoreEl.textContent = score;

    if (typeof currentTimer !== 'undefined' && currentTimer) {
        clearInterval(currentTimer);
        currentTimer = null;
    }

    function formatNum(n) {
        return n >= 0 ? `(+${n})` : `(${n})`;
    }

    function gen() {
        const type = Math.floor(Math.random() * 2); // 0: Çarpma, 1: Bölme
        let a, b, correctAns, opSym;

        if (type === 0) {
            // Çarpma: -12 ile 12 arası sayılar
            a = (Math.floor(Math.random() * 25) - 12);
            b = (Math.floor(Math.random() * 25) - 12);
            if (a === 0 && b === 0) a = 5; // İkisi birden 0 olmasın
            opSym = "·"; // Çarpma noktası
            correctAns = a * b;
        } else {
            // Bölme: Tam bölünme garantisi için çarpma üzerinden git
            let divisor = (Math.floor(Math.random() * 11) - 5); 
            if (divisor === 0) divisor = 2; // Payda 0 olamaz
            let result = (Math.floor(Math.random() * 21) - 10);
            let dividend = divisor * result;
            
            a = dividend;
            b = divisor;
            opSym = "÷"; // Bölme sembolü
            correctAns = result;
        }

        questionEl.textContent = `${formatNum(a)} ${opSym} ${formatNum(b)} = ?`;

        // Şıkları oluşturma
        let opts = new Set([correctAns]);
        
        // İşaret hatası çeldiricisi
        opts.add(-(correctAns)); 
        // Toplama/Çıkarma hatası çeldiricileri
        opts.add(a + b);
        opts.add(a - b);
        
        let optArr = Array.from(opts);
        while (optArr.length < 4) {
            let offset = Math.floor(Math.random() * 10) - 5;
            let wrong = correctAns + (offset === 0 ? 3 : offset);
            if (!optArr.includes(wrong)) optArr.push(wrong);
        }
        
        optArr = optArr.slice(0, 4).sort(() => Math.random() - 0.5);

        ansContainer.innerHTML = '';
        optArr.forEach(o => {
            const btn = document.createElement('button');
            btn.className = 'answer-btn';
            btn.style.fontSize = "22px";
            btn.textContent = o > 0 ? `+${o}` : o;
            if (o === 0) btn.textContent = "0";

            btn.onclick = () => {
                if (btn.disabled) return;
                document.querySelectorAll('#intmd-answers button').forEach(b => b.disabled = true);
                
                if (o === correctAns) {
                    btn.classList.add('correct');
                    score += 20;
                } else {
                    btn.classList.add('wrong');
                }
                
                if (scoreEl) scoreEl.textContent = score;
                setTimeout(gen, 1000);
            };
            ansContainer.appendChild(btn);
        });
    }

    gen();
},


  rationalToDecimalGame: function() {
    let score = 0;
    const scoreEl = document.getElementById('rat-score');
    const numEl = document.getElementById('rat-num');
    const denEl = document.getElementById('rat-den');
    const ansContainer = document.getElementById('rat-answers');

    if (scoreEl) scoreEl.textContent = score;

    if (typeof currentTimer !== 'undefined' && currentTimer) {
        clearInterval(currentTimer);
        currentTimer = null;
    }

    // Ondalık sayıyı devirli formata sokan yardımcı fonksiyon
    function formatDecimal(n, d) {
        const val = n / d;
        const s = val.toString();
        
        // Basit devirliler için (1/3, 2/3, 1/9 vb.)
        if (d === 3 || d === 9) {
            let digit = Math.floor((n * 10) / d) % 10;
            let integerPart = Math.floor(n / d);
            return `${integerPart},<span style="border-top: 2px solid black;">${digit}</span>`;
        }
        if (d === 6) {
            // Örn: 1/6 = 0,1666... -> 0,16 (6 devirli)
            let integerPart = Math.floor(n / d);
            let firstDigit = Math.floor((n * 10) / d) % 10;
            let repeatingDigit = Math.floor((n * 100) / d) % 10;
            return `${integerPart},${firstDigit}<span style="border-top: 2px solid black;">${repeatingDigit}</span>`;
        }

        // Devirli olmayanlar (Paydası 2, 4, 5, 8, 10 olanlar)
        return val.toLocaleString('tr-TR', { minimumFractionDigits: 0, maximumFractionDigits: 3 });
    }

    function gen() {
        const denominators = [2, 4, 5, 8, 10, 3, 6, 9];
        const d = denominators[Math.floor(Math.random() * denominators.length)];
        let n = Math.floor(Math.random() * 10) + 1;
        
        // Sadeleşmiş formda kalsın veya tam sayı çıkmasın diye
        if (n % d === 0) n += 1;

        numEl.textContent = n;
        denEl.textContent = d;

        const correctDisplay = formatDecimal(n, d);
        const correctVal = (n / d).toFixed(4); // Karşılaştırma için gizli değer

        // Şıkları oluştur
        let opts = [{ display: correctDisplay, val: correctVal }];
        
        while (opts.length < 4) {
            let offset = (Math.random() * 0.5 - 0.25).toFixed(2);
            let wVal = (parseFloat(correctVal) + parseFloat(offset)).toFixed(2);
            let wDisplay = wVal.toString().replace('.', ',');
            
            if (!opts.some(o => o.val === wVal) && wVal > 0) {
                opts.push({ display: wDisplay, val: wVal });
            }
        }

        opts.sort(() => Math.random() - 0.5);

        ansContainer.innerHTML = '';
        opts.forEach(o => {
            const btn = document.createElement('button');
            btn.className = 'answer-btn';
            btn.innerHTML = o.display; // HTML içeriği (çizgi için) destekler
            btn.onclick = () => {
                if (btn.disabled) return;
                document.querySelectorAll('#rat-answers button').forEach(b => b.disabled = true);
                
                if (o.val === correctVal) {
                    btn.classList.add('correct');
                    score += 25;
                } else {
                    btn.classList.add('wrong');
                }
                
                scoreEl.textContent = score;
                setTimeout(gen, 1200);
            };
            ansContainer.appendChild(btn);
        });
    }

    gen();
},


rationalOpGame: function() {
    let score = 0;
    const scoreEl = document.getElementById('ratop-score');
    const n1El = document.getElementById('ratop-n1');
    const d1El = document.getElementById('ratop-d1');
    const n2El = document.getElementById('ratop-n2');
    const d2El = document.getElementById('ratop-d2');
    const opEl = document.getElementById('ratop-op');
    const ansContainer = document.getElementById('ratop-answers');

    if (scoreEl) scoreEl.textContent = score;

    if (typeof currentTimer !== 'undefined' && currentTimer) {
        clearInterval(currentTimer);
        currentTimer = null;
    }

    function getGCD(a, b) {
        a = Math.abs(a);
        b = Math.abs(b);
        return b === 0 ? a : getGCD(b, a % b);
    }

    const gen = () => {
        const dens = [2, 3, 4, 5, 6, 8, 10, 12];
        let d1 = dens[Math.floor(Math.random() * dens.length)];
        let d2 = dens[Math.floor(Math.random() * dens.length)];
        
        // %50 ihtimalle paydaları eşitle veya katı yap (Öğretici kolaylık)
        if (Math.random() > 0.5) d2 = d1; 

        let n1 = Math.floor(Math.random() * 6) + 1;
        let n2 = Math.floor(Math.random() * 6) + 1;
        
        const type = Math.floor(Math.random() * 2); // 0: Toplama, 1: Çıkarma
        const op = type === 0 ? "+" : "-";

        // Çıkarma işleminde negatifliği önlemek için güvenli kontrol
        if (type === 1) {
            if ((n1 * d2) < (n2 * d1)) {
                // Yer değiştir
                [n1, n2] = [n2, n1];
                [d1, d2] = [d2, d1];
            }
            // Hala eşitlerse (sonuç 0 çıkmasın diye) n1'i artır
            if (n1 * d2 === n2 * d1) n1++;
        }

        n1El.textContent = n1; d1El.textContent = d1;
        n2El.textContent = n2; d2El.textContent = d2;
        opEl.textContent = op;

        // Hesaplama: (n1*d2 ± n2*d1) / (d1*d2)
        let resNum = (type === 0) ? (n1 * d2 + n2 * d1) : (n1 * d2 - n2 * d1);
        let resDen = d1 * d2;

        const common = getGCD(resNum, resDen);
        resNum /= common;
        resDen /= common;

        const correctAns = `${resNum}/${resDen}`;

        // Şıkları oluştur
        let opts = [correctAns];
        while (opts.length < 4) {
            let wn = Math.max(1, resNum + (Math.floor(Math.random() * 5) - 2));
            let wd = Math.max(2, resDen + (Math.floor(Math.random() * 5) - 2));
            let wAns = `${wn}/${wd}`;
            if (!opts.includes(wAns)) opts.push(wAns);
        }

        opts.sort(() => Math.random() - 0.5);

        ansContainer.innerHTML = '';
        opts.forEach(opt => {
            const parts = opt.split('/');
            const btn = document.createElement('button');
            btn.className = 'answer-btn';
            btn.style.height = "auto";
            btn.innerHTML = `
                <div style="display: flex; flex-direction: column; align-items: center; padding: 5px;">
                    <div>${parts[0]}</div>
                    <div style="width: 20px; height: 2px; background: currentColor; margin: 2px 0;"></div>
                    <div>${parts[1]}</div>
                </div>`;

            btn.onclick = () => {
                if (btn.disabled) return;
                document.querySelectorAll('#ratop-answers button').forEach(b => b.disabled = true);
                if (opt === correctAns) {
                    btn.classList.add('correct');
                    score += 30;
                } else {
                    btn.classList.add('wrong');
                }
                scoreEl.textContent = score;
                setTimeout(gen, 1000);
            };
            ansContainer.appendChild(btn);
        });
    }
    gen();
},
  

rationalMulDivGame: function() {
    let score = 0;
    const scoreEl = document.getElementById('ratmd-score');
    const n1El = document.getElementById('ratmd-n1');
    const d1El = document.getElementById('ratmd-d1');
    const n2El = document.getElementById('ratmd-n2');
    const d2El = document.getElementById('ratmd-d2');
    const opEl = document.getElementById('ratmd-op');
    const ansContainer = document.getElementById('ratmd-answers');

    if (scoreEl) scoreEl.textContent = score;

    if (typeof currentTimer !== 'undefined' && currentTimer) {
        clearInterval(currentTimer);
        currentTimer = null;
    }

    function getGCD(a, b) {
        return b === 0 ? Math.abs(a) : getGCD(b, a % b);
    }

    const gen = () => {
        // Sayıları 1-10 arası seçiyoruz ki işlemler çok devasa olmasın
        let n1 = Math.floor(Math.random() * 9) + 1;
        let d1 = Math.floor(Math.random() * 9) + 2;
        let n2 = Math.floor(Math.random() * 9) + 1;
        let d2 = Math.floor(Math.random() * 9) + 2;
        
        const type = Math.floor(Math.random() * 2); // 0: Çarpma, 1: Bölme
        const op = type === 0 ? "×" : "÷";
        
        n1El.textContent = n1; d1El.textContent = d1;
        n2El.textContent = n2; d2El.textContent = d2;
        opEl.textContent = op;

        let resNum, resDen;

        if (type === 0) { // Çarpma: Paylar çarpımı / Paydalar çarpımı
            resNum = n1 * n2;
            resDen = d1 * d2;
        } else { // Bölme: n1/d1 * d2/n2
            resNum = n1 * d2;
            resDen = d1 * n2;
        }

        // Sadeleştirme
        const common = getGCD(resNum, resDen);
        resNum /= common;
        resDen /= common;

        const correctAns = `${resNum}/${resDen}`;

        // Şıkları oluştur
        let opts = [correctAns];
        while (opts.length < 4) {
            let wn = Math.max(1, resNum + (Math.floor(Math.random() * 5) - 2));
            let wd = Math.max(2, resDen + (Math.floor(Math.random() * 5) - 2));
            let wAns = `${wn}/${wd}`;
            if (!opts.includes(wAns)) opts.push(wAns);
        }

        opts.sort(() => Math.random() - 0.5);

        ansContainer.innerHTML = '';
        opts.forEach(opt => {
            const parts = opt.split('/');
            const btn = document.createElement('button');
            btn.className = 'answer-btn';
            btn.style.height = "auto";
            btn.innerHTML = `
                <div style="display: flex; flex-direction: column; align-items: center; padding: 5px;">
                    <div>${parts[0]}</div>
                    <div style="width: 20px; height: 2px; background: currentColor; margin: 2px 0;"></div>
                    <div>${parts[1]}</div>
                </div>`;

            btn.onclick = () => {
                if (btn.disabled) return;
                document.querySelectorAll('#ratmd-answers button').forEach(b => b.disabled = true);
                if (opt === correctAns) {
                    btn.classList.add('correct');
                    score += 20;
                } else {
                    btn.classList.add('wrong');
                }
                scoreEl.textContent = score;
                setTimeout(gen, 1000);
            };
            ansContainer.appendChild(btn);
        });
    }
    gen();
},



multiStepRationalGame: function() {
    let score = 0;
    const scoreEl = document.getElementById('msr-score');
    const questionEl = document.getElementById('msr-question');
    const ansContainer = document.getElementById('msr-answers');

    if (scoreEl) scoreEl.textContent = score;

    if (typeof currentTimer !== 'undefined' && currentTimer) {
        clearInterval(currentTimer);
        currentTimer = null;
    }

    function getGCD(a, b) {
        return b === 0 ? Math.abs(a) : getGCD(b, a % b);
    }

    const gen = () => {
        // İki farklı kalıp arasından seçim yapıyoruz
        const pattern = Math.floor(Math.random() * 2);
        let resNum, resDen, htmlStr;

        if (pattern === 0) {
            // Kalıp: 1 + (1 / (1 + a/b))
            let a = Math.floor(Math.random() * 3) + 1;
            let b = Math.floor(Math.random() * 4) + 2;
            
            // İç kısım: 1 + a/b = (b+a)/b
            // Ters çevrilmiş: b / (b+a)
            // Sonuç: 1 + b/(b+a) = (b+a+b) / (b+a)
            resNum = (2 * b) + a;
            resDen = b + a;

            htmlStr = `
                <div style="display:flex; align-items:center;">
                    1 + 
                    <div style="display:inline-flex; flex-direction:column; align-items:center; margin-left:10px;">
                        <div>1</div>
                        <div style="width:100%; height:2px; background:black; margin:3px 0;"></div>
                        <div style="display:flex; align-items:center;">
                            1 + 
                            <div style="display:inline-flex; flex-direction:column; align-items:center; margin-left:5px; font-size:0.8em;">
                                <div>${a}</div>
                                <div style="width:20px; height:2px; background:black; margin:2px 0;"></div>
                                <div>${b}</div>
                            </div>
                        </div>
                    </div>
                </div>`;
        } else {
            // Kalıp: (1 - a/b) / c
            let a = 1;
            let b = Math.floor(Math.random() * 3) + 2;
            let c = Math.floor(Math.random() * 3) + 2;

            // Üst kısım: (b-a)/b
            // Sonuç: (b-a) / (b*c)
            resNum = b - a;
            resDen = b * c;

            htmlStr = `
                <div style="display:inline-flex; flex-direction:column; align-items:center;">
                    <div style="display:flex; align-items:center; font-size:0.8em;">
                        1 - 
                        <div style="display:inline-flex; flex-direction:column; align-items:center; margin-left:5px;">
                            <div>${a}</div>
                            <div style="width:20px; height:2px; background:black; margin:2px 0;"></div>
                            <div>${b}</div>
                        </div>
                    </div>
                    <div style="width:120%; height:3px; background:black; margin:5px 0;"></div>
                    <div>${c}</div>
                </div>`;
        }

        // Sadeleştirme
        const common = getGCD(resNum, resDen);
        resNum /= common;
        resDen /= common;

        const correctAns = `${resNum}/${resDen}`;
        questionEl.innerHTML = htmlStr;

        // Şıkları oluştur
        let opts = [correctAns];
        while (opts.length < 4) {
            let wn = Math.max(1, resNum + (Math.floor(Math.random() * 5) - 2));
            let wd = Math.max(2, resDen + (Math.floor(Math.random() * 5) - 2));
            let wAns = `${wn}/${wd}`;
            if (!opts.includes(wAns)) opts.push(wAns);
        }

        opts.sort(() => Math.random() - 0.5);

        ansContainer.innerHTML = '';
        opts.forEach(opt => {
            const parts = opt.split('/');
            const btn = document.createElement('button');
            btn.className = 'answer-btn';
            btn.style.height = "auto";
            btn.innerHTML = `
                <div style="display: flex; flex-direction: column; align-items: center; padding: 5px;">
                    <div>${parts[0]}</div>
                    <div style="width: 20px; height: 2px; background: currentColor; margin: 2px 0;"></div>
                    <div>${parts[1]}</div>
                </div>`;

            btn.onclick = () => {
                if (btn.disabled) return;
                document.querySelectorAll('#msr-answers button').forEach(b => b.disabled = true);
                if (opt === correctAns) {
                    btn.classList.add('correct');
                    score += 40; // Çok adımlı olduğu için puan daha yüksek
                } else {
                    btn.classList.add('wrong');
                }
                scoreEl.textContent = score;
                setTimeout(gen, 1200);
            };
            ansContainer.appendChild(btn);
        });
    }
    gen();
},

  factorsGame: function() {
    let score = 0;
    const scoreEl = document.getElementById('fact-score');
    const numEl = document.getElementById('fact-number');
    const qTextEl = document.getElementById('fact-question-text');
    const ansContainer = document.getElementById('fact-answers');

    if (scoreEl) scoreEl.textContent = score;

    if (typeof currentTimer !== 'undefined' && currentTimer) {
        clearInterval(currentTimer);
        currentTimer = null;
    }

    // Asal çarpanlara ayırma fonksiyonu (Optimize edildi)
    function getPrimeFactors(n) {
        let factors = {};
        let d = 2;
        let temp = n;
        while (d * d <= temp) {
            while (temp % d === 0) {
                factors[d] = (factors[d] || 0) + 1;
                temp /= d;
            }
            d++;
        }
        if (temp > 1) factors[temp] = (factors[temp] || 0) + 1;
        return factors;
    }

    function formatFactors(factors) {
        let keys = Object.keys(factors).sort((a,b) => a-b);
        return keys.map(p => {
            let exp = factors[p];
            return exp > 1 ? `${p}<sup>${exp}</sup>` : `${p}`;
        }).join(' . ');
    }

    const gen = () => {
        const numbers = [12, 18, 20, 24, 30, 36, 40, 45, 48, 50, 60, 72, 80, 84, 90, 96, 100];
        let n = numbers[Math.floor(Math.random() * numbers.length)];
        
        const type = Math.floor(Math.random() * 2); 
        let correctAnsHTML = "";
        let options = [];

        numEl.textContent = n;

        if (type === 0) {
            qTextEl.textContent = "Hangisi bu sayının bir çarpanıdır?";
            let divisors = [];
            for(let i=1; i<=n; i++) if(n % i === 0) divisors.push(i);
            
            // 1 ve kendisi hariç rastgele bir bölen seç
            let correct = divisors[Math.floor(Math.random() * (divisors.length - 1))];
            correctAnsHTML = correct.toString();
            options.push(correctAnsHTML);

            // Yanlış şıklar için havuz kullan (Döngü takılmasını önler)
            const wrongPool = [7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47];
            wrongPool.sort(() => Math.random() - 0.5);
            
            for(let w of wrongPool) {
                if(options.length >= 4) break;
                if(n % w !== 0) options.push(w.toString());
            }
        } else {
            qTextEl.textContent = "Asal çarpanların çarpımı şeklinde yazılışı hangisidir?";
            correctAnsHTML = formatFactors(getPrimeFactors(n));
            options.push(correctAnsHTML);

            // Yanlışlar için n'e yakın diğer sayıların asal çarpanlarını kullan
            let neighbors = [n+2, n-2, n+4, n-4, n+6, n-6];
            for(let neigh of neighbors) {
                if(options.length >= 4) break;
                if(neigh > 1) {
                    let f = formatFactors(getPrimeFactors(neigh));
                    if(!options.includes(f)) options.push(f);
                }
            }
        }

        // Şıkları karıştır ve eksik varsa rastgele doldur
        while(options.length < 4) options.push("7 . 2");
        options.sort(() => Math.random() - 0.5);

        ansContainer.innerHTML = '';
        options.forEach(opt => {
            const btn = document.createElement('button');
            btn.className = 'answer-btn';
            btn.innerHTML = opt;
            btn.onclick = () => {
                if (btn.disabled) return;
                document.querySelectorAll('#fact-answers button').forEach(b => b.disabled = true);
                if (opt === correctAnsHTML) {
                    btn.classList.add('correct');
                    score += 25;
                } else {
                    btn.classList.add('wrong');
                }
                scoreEl.textContent = score;
                setTimeout(gen, 800);
            };
            ansContainer.appendChild(btn);
        });
    }
    gen();
},


ebobEkokGame: function() {
    let score = 0;
    const scoreEl = document.getElementById('ee-score');
    const num1El = document.getElementById('ee-num1');
    const num2El = document.getElementById('ee-num2');
    const qTextEl = document.getElementById('ee-question-text');
    const ansContainer = document.getElementById('ee-answers');

    if (scoreEl) scoreEl.textContent = score;

    if (typeof currentTimer !== 'undefined' && currentTimer) {
        clearInterval(currentTimer);
        currentTimer = null;
    }

    // EBOB (En Büyük Ortak Bölen)
    function getEBOB(a, b) {
        return b === 0 ? a : getEBOB(b, a % b);
    }

    // EKOK (En Küçük Ortak Kat)
    function getEKOK(a, b) {
        return (a * b) / getEBOB(a, b);
    }

    const gen = () => {
        // Birbirinin katı olan veya ortak böleni bol olan sayılar
        const pairs = [
            [12, 18], [15, 20], [24, 36], [10, 25], [12, 16], 
            [20, 30], [8, 12], [18, 24], [9, 12], [40, 60]
        ];
        let pair = pairs[Math.floor(Math.random() * pairs.length)];
        let a = pair[0], b = pair[1];
        
        const type = Math.floor(Math.random() * 2); // 0: EBOB, 1: EKOK
        let correct;

        num1El.textContent = a;
        num2El.textContent = b;

        if (type === 0) {
            qTextEl.textContent = "Bu sayıların EBOB'u kaçtır?";
            correct = getEBOB(a, b);
        } else {
            qTextEl.textContent = "Bu sayıların EKOK'u kaçtır?";
            correct = getEKOK(a, b);
        }

        // Şıkları oluştur
        let opts = new Set([correct]);
        
        // Çeldiriciler: EBOB yerine EKOK, EKOK yerine EBOB, sayıların kendisi vb.
        opts.add(getEBOB(a, b));
        opts.add(getEKOK(a, b));
        opts.add(a);
        opts.add(b);
        opts.add(Math.abs(a - b));

        let optArr = Array.from(opts);
        while (optArr.length < 4) {
            let fake = correct + (Math.floor(Math.random() * 5) + 1);
            if (!optArr.includes(fake)) optArr.push(fake);
        }

        optArr = optArr.slice(0, 4).sort(() => Math.random() - 0.5);

        ansContainer.innerHTML = '';
        optArr.forEach(o => {
            const btn = document.createElement('button');
            btn.className = 'answer-btn';
            btn.textContent = o;
            btn.onclick = () => {
                if (btn.disabled) return;
                document.querySelectorAll('#ee-answers button').forEach(b => b.disabled = true);
                
                if (o === correct) {
                    btn.classList.add('correct');
                    score += 30; // EBOB-EKOK biraz daha zordur
                } else {
                    btn.classList.add('wrong');
                }
                scoreEl.textContent = score;
                setTimeout(gen, 1000);
            };
            ansContainer.appendChild(btn);
        });
    }

    gen();
},


coprimeGame: function() {
    let score = 0;
    const scoreEl = document.getElementById('cp-score');
    const num1El = document.getElementById('cp-num1');
    const num2El = document.getElementById('cp-num2');
    const ansContainer = document.getElementById('cp-answers');

    if (scoreEl) scoreEl.textContent = score;

    if (typeof currentTimer !== 'undefined' && currentTimer) {
        clearInterval(currentTimer);
        currentTimer = null;
    }

    // EBOB fonksiyonu (Aralarında asallık kontrolü için)
    function getGCD(a, b) {
        return b === 0 ? a : getGCD(b, a % b);
    }

    const gen = () => {
        let a, b, isCoprime;

        // %50 ihtimalle aralarında asal olan veya olmayan çiftler üret
        if (Math.random() > 0.5) {
            // Aralarında asal olmayan üret (Ortak bölen ekle)
            const common = Math.floor(Math.random() * 5) + 2; // 2, 3, 4, 5, 6
            a = common * (Math.floor(Math.random() * 10) + 2);
            b = common * (Math.floor(Math.random() * 10) + 2);
            if (a === b) b += common;
        } else {
            // Aralarında asal olma ihtimali yüksek sayılar üret
            a = Math.floor(Math.random() * 40) + 7;
            b = Math.floor(Math.random() * 40) + 7;
        }

        isCoprime = getGCD(a, b) === 1;
        num1El.textContent = a;
        num2El.textContent = b;

        const options = [
            { text: "EVET (Aralarında Asal)", value: true },
            { text: "HAYIR (Değil)", value: false }
        ];

        ansContainer.innerHTML = '';
        options.forEach(opt => {
            const btn = document.createElement('button');
            btn.className = 'answer-btn';
            btn.style.padding = "15px 25px";
            btn.style.fontSize = "18px";
            btn.style.minWidth = "180px";
            btn.textContent = opt.text;

            btn.onclick = () => {
                if (btn.disabled) return;
                document.querySelectorAll('#cp-answers button').forEach(b => b.disabled = true);
                
                if (opt.value === isCoprime) {
                    btn.classList.add('correct');
                    score += 20;
                } else {
                    btn.classList.add('wrong');
                }
                
                scoreEl.textContent = score;
                setTimeout(gen, 800);
            };
            ansContainer.appendChild(btn);
        });
    }

    gen();
},




  integerPowerGame: function() {
    let score = 0;
    const scoreEl = document.getElementById('pow-score');
    const baseEl = document.getElementById('pow-base');
    const expEl = document.getElementById('pow-exponent');
    const ansContainer = document.getElementById('pow-answers');

    if (scoreEl) scoreEl.textContent = score;

    if (typeof currentTimer !== 'undefined' && currentTimer) {
        clearInterval(currentTimer);
        currentTimer = null;
    }

    const gen = () => {
        // Taban: -5 ile 5 arası (0 hariç)
        let base = Math.floor(Math.random() * 11) - 5;
        if (base === 0) base = 2;
        
        // Üst: -3 ile 4 arası
        let exp = Math.floor(Math.random() * 8) - 3;
        
        baseEl.textContent = base < 0 ? `(${base})` : base;
        expEl.textContent = exp;

        let correctAns;
        let isFraction = false;

        if (exp >= 0) {
            correctAns = Math.pow(base, exp);
        } else {
            // Negatif kuvvet durumu: 1 / base^|exp|
            isFraction = true;
            let den = Math.pow(base, Math.abs(exp));
            // İşareti paya taşıyalım (Matematiksel standart)
            if (den < 0) {
                correctAns = `-1/${Math.abs(den)}`;
            } else {
                correctAns = `1/${den}`;
            }
        }

        // Şıkları oluştur
        let opts = new Set([correctAns.toString()]);
        
        while (opts.size < 4) {
            let fake;
            if (isFraction) {
                let fakeDen = Math.pow(Math.abs(base), Math.abs(exp)) + (Math.floor(Math.random() * 5) - 2);
                if (fakeDen <= 0) fakeDen = 5;
                fake = (Math.random() > 0.5 ? "" : "-") + `1/${fakeDen}`;
            } else {
                // Yaygın hatalar: Taban*Üst, Ters işaret, veya +-1 fark
                let errors = [base * exp, -correctAns, correctAns + 1, correctAns - 1];
                fake = errors[Math.floor(Math.random() * errors.length)].toString();
            }
            if (fake !== "NaN") opts.add(fake);
        }

        let optArr = Array.from(opts).sort(() => Math.random() - 0.5);

        ansContainer.innerHTML = '';
        optArr.forEach(opt => {
            const btn = document.createElement('button');
            btn.className = 'answer-btn';
            btn.style.fontSize = "20px";
            
            // Kesirli şık görünümü için düzenleme
            if (opt.includes('/')) {
                let parts = opt.split('/');
                btn.innerHTML = `<div style="display:flex; flex-direction:column; align-items:center;">
                    <div>${parts[0]}</div>
                    <div style="width:20px; height:2px; background:currentColor; margin:2px 0;"></div>
                    <div>${parts[1]}</div>
                </div>`;
            } else {
                btn.textContent = opt > 0 && !opt.includes('-') ? `+${opt}` : opt;
                if (opt === "0") btn.textContent = "0";
            }

            btn.onclick = () => {
                if (btn.disabled) return;
                document.querySelectorAll('#pow-answers button').forEach(b => b.disabled = true);
                
                if (opt === correctAns.toString()) {
                    btn.classList.add('correct');
                    score += 25;
                } else {
                    btn.classList.add('wrong');
                }
                scoreEl.textContent = score;
                setTimeout(gen, 1000);
            };
            ansContainer.appendChild(btn);
        });
    }

    gen();
},
  

combinedPowerGame: function() {
    let score = 0;
    const scoreEl = document.getElementById('comb-score');
    const questionEl = document.getElementById('comb-question');
    const hintEl = document.getElementById('comb-hint');
    const ansContainer = document.getElementById('comb-answers');

    if (scoreEl) scoreEl.textContent = score;

    // Varsa eski zamanlayıcıları temizle
    if (typeof currentTimer !== 'undefined' && currentTimer) {
        clearInterval(currentTimer);
        currentTimer = null;
    }

    const gen = () => {
        // %50 ihtimalle İşlem veya Dönüşüm modunu seç
        const mode = Math.random() > 0.5 ? 'islem' : 'donusum';
        let correctStr = "";
        let opts = [];

        if (mode === 'islem') {
            hintEl.textContent = "İşlemi yap ve sonucu bul:";
            let base = [2, 3, 5, 10][Math.floor(Math.random() * 4)];
            let e1 = Math.floor(Math.random() * 6) + 2;
            let e2 = Math.floor(Math.random() * 5) + 2;
            let type = Math.random() > 0.5 ? 'carp' : 'bol';

            if (type === 'carp') {
                questionEl.innerHTML = `${base}<sup>${e1}</sup> · ${base}<sup>${e2}</sup> = ?`;
                correctStr = `${base}<sup>${e1 + e2}</sup>`;
                // Çeldiriciler: Üstleri çarpma, tabanları çarpma, üstleri çıkarma
                opts = [correctStr, `${base}<sup>${e1 * e2}</sup>`, `${base * 2}<sup>${e1 + e2}</sup>`, `${base}<sup>${Math.abs(e1 - e2)}</sup>` ];
            } else {
                questionEl.innerHTML = `${base}<sup>${e1 + e2}</sup> : ${base}<sup>${e1}</sup> = ?`;
                correctStr = `${base}<sup>${e2}</sup>`;
                // Çeldiriciler: Üstleri toplama, tabanları bölme, üstleri bölme
                opts = [correctStr, `${base}<sup>${e1 + e2 + e1}</sup>`, `1<sup>${e2}</sup>`, `${base}<sup>${Math.floor((e1+e2)/e1)}</sup>` ];
            }
        } else {
            hintEl.textContent = "Verilen ifadeye denk olanı bul:";
            const pool = [
                { q: "4<sup>3</sup>", a: "2<sup>6</sup>", w: ["2<sup>7</sup>", "4<sup>2</sup>", "8<sup>3</sup>"] },
                { q: "9<sup>2</sup>", a: "3<sup>4</sup>", w: ["3<sup>2</sup>", "9<sup>3</sup>", "27<sup>2</sup>"] },
                { q: "27<sup>2</sup>", a: "3<sup>6</sup>", w: ["3<sup>5</sup>", "9<sup>4</sup>", "81<sup>2</sup>"] },
                { q: "16<sup>2</sup>", a: "2<sup>8</sup>", w: ["2<sup>6</sup>", "4<sup>3</sup>", "32<sup>2</sup>"] },
                { q: "25<sup>3</sup>", a: "5<sup>6</sup>", w: ["5<sup>5</sup>", "125<sup>2</sup>", "5<sup>9</sup>"] },
                { q: "100<sup>2</sup>", a: "10<sup>4</sup>", w: ["10<sup>3</sup>", "10<sup>6</sup>", "1000<sup>2</sup>"] },
                { q: "8<sup>2</sup>", a: "2<sup>6</sup>", w: ["2<sup>5</sup>", "4<sup>4</sup>", "2<sup>8</sup>"] },
                { q: "49<sup>2</sup>", a: "7<sup>4</sup>", w: ["7<sup>3</sup>", "7<sup>6</sup>", "14<sup>2</sup>"] }
            ];
            let target = pool[Math.floor(Math.random() * pool.length)];
            questionEl.innerHTML = `${target.q} = ?`;
            correctStr = target.a;
            opts = [correctStr, ...target.w];
        }

        // Şıkları karıştır
        opts.sort(() => Math.random() - 0.5);
        ansContainer.innerHTML = '';

        opts.forEach(opt => {
            const btn = document.createElement('button');
            btn.className = 'answer-btn';
            btn.innerHTML = opt;
            btn.onclick = () => {
                if (btn.disabled) return;
                document.querySelectorAll('#comb-answers button').forEach(b => b.disabled = true);
                
                if (opt === correctStr) {
                    btn.classList.add('correct');
                    score += 30;
                } else {
                    btn.classList.add('wrong');
                }
                scoreEl.textContent = score;
                setTimeout(gen, 1000);
            };
            ansContainer.appendChild(btn);
        });
    };

    gen();
},


  
  shapes: function() {
    let score = 0, combo = 0;
    const scoreEl = document.getElementById('shape-score');
    
    scoreEl.textContent = score;
    
    if (typeof currentTimer !== 'undefined' && currentTimer) {
        clearInterval(currentTimer);
        currentTimer = null;
    }

    const shapes = ['circle','square','triangle','star'];

    function gen() {
      const target = shapes[Math.floor(Math.random()*4)];
      document.getElementById('target-shape-display').className = `shape ${target}`;
      const board = document.getElementById('shape-board'); board.innerHTML = '';
      let cards = [target];
      while (cards.length < 8) {
        cards.push(shapes.filter(s=>s!==target)[Math.floor(Math.random()*3)]);
      }
      cards.sort(() => Math.random() - 0.5);
      cards.forEach(sh => {
        const div = document.createElement('div');
        div.className = `shape ${sh}`;
        div.onclick = () => {
          if (div.dataset.clicked) return;
          div.dataset.clicked = '1';
          if (sh === target) {
            score += 10; combo++;
            if (combo % 3 === 0) score += 15;
            div.style.background = '#b2ffba';
          } else {
            combo = 0;
            div.style.background = '#ff9e9e';
          }
          scoreEl.textContent = score;
          setTimeout(gen, 600);
        };
        board.appendChild(div);
      });
    }
    gen();
  },

  memory: function() {
    let score = 0, combo = 0, pairsFound = 0, flipped = [], lock = false;
    const scoreEl = document.getElementById('mem-score');
    const pairsEl = document.getElementById('mem-pairs');
   
    scoreEl.textContent = score;
    pairsEl.textContent = pairsFound;
   
     if (typeof currentTimer !== 'undefined' && currentTimer) {
        clearInterval(currentTimer);
        currentTimer = null;
    }

    const symbols = ['🍎','🍌','🍇','🍊','🍉','🍓','🥝','🍍','🍎','🍌','🍇','🍊','🍉','🍓','🥝','🍍'].sort(() => Math.random() - 0.5);
    const board = document.getElementById('mem-board');
    board.innerHTML = '';
    symbols.forEach(sym => {
      const card = document.createElement('div');
      card.className = 'mem-card';
      card.dataset.symbol = sym;
      card.onclick = () => {
        if (lock || flipped.length === 2 || card.classList.contains('flipped')) return;
        card.classList.add('flipped');
        card.textContent = sym;
        flipped.push(card);
        if (flipped.length === 2) {
          lock = true;
          setTimeout(() => {
            if (flipped[0].dataset.symbol === flipped[1].dataset.symbol) {
              flipped.forEach(c => c.classList.add('matched'));
              pairsFound++;
              score += 10; combo++;
              if (combo % 3 === 0) score += 15;
              pairsEl.textContent = pairsFound;
              if (pairsFound === 8) {
                clearInterval(currentTimer);
                currentTimer = null;
                window._saveLocalScore('memory', score);
              }
            } else {
              flipped.forEach(c => { c.classList.remove('flipped'); c.textContent = ''; });
              combo = 0;
            }
            scoreEl.textContent = score;
            flipped = [];
            lock = false;
          }, 1000);
        }
      };
      board.appendChild(card);
    });
  }
};

// Panel ve oyun geçiş yönetimi
document.addEventListener('click', function(e) {
  if (e.target.matches('.tab') || e.target.matches('.go')) {
    const targetId = e.target.dataset.target;

    // Tüm panelleri gizle
    document.querySelectorAll('.panel').forEach(p => p.classList.add('hidden'));

    // Hedef paneli göster
    const targetPanel = document.getElementById(targetId);
    if (targetPanel) targetPanel.classList.remove('hidden');

    // Tab aktifliğini güncelle
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    const activeTab = document.querySelector(`.tab[data-target="${targetId}"]`);
    if (activeTab) activeTab.classList.add('active');

    // Eğer oyun paneliyse başlat
    if (gameInitFunctions[targetId]) {
      if (currentTimer) clearInterval(currentTimer);
      currentTimer = null;

      const scoreEls = targetPanel.querySelectorAll('[id$="-score"]');
      scoreEls.forEach(el => el.textContent = '0');
      
      if (targetPanel.querySelector('#mem-pairs')) targetPanel.querySelector('#mem-pairs').textContent = '0';

      gameInitFunctions[targetId]();
    }
  }
});
</script>
  

<script src="app.js"></script>
  
  <script>
// Ziyaretçi sayacı – anasayfada her yüklenmede artar
function updateVisitorCount() {
  const STORAGE_KEY = 'site_ziyaretci_sayaci_2025';  // benzersiz anahtar

  let count = localStorage.getItem(STORAGE_KEY);
  count = count ? parseInt(count, 10) : 0;
  
  count += 1;
  localStorage.setItem(STORAGE_KEY, count);

  const countEl = document.getElementById('visitor-count');
  if (countEl) {
    countEl.textContent = count.toLocaleString('tr-TR');  // 1.234 gibi okunaklı format
  }
}

// Sayfa yüklendiğinde çalıştır
document.addEventListener('DOMContentLoaded', updateVisitorCount);
</script>
  
<!-- Ziyaretçi Sayacı - Sayfa Altı -->
<footer class="site-footer" style="text-align: center; padding: 20px 15px; background: #f8f9fa; border-top: 1px solid #e0e0e0; font-size: 0.95rem; color: #555; margin-top: 40px;">
  <div class="visitor-counter">
    <span style="margin-right: 6px;">👥</span>
    Bu siteyi ziyaret eden kişi sayısı: 
    <strong id="visitor-count" style="color: #e53e3e; font-weight: 600;">0</strong>
  </div>
  <div style="margin-top: 8px; font-size: 0.85rem; color: #777;">
  
  </div>
</footer>
  
</body>
</html>
