<!doctype html>
<html lang="tr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Matematik OyunlarÄ± â€” matbilzek</title>
<meta name="description" content="EÄŸitsel matematik oyunlarÄ± â€” Ä°lkokul, Ortaokul(6. sÄ±nÄ±f) ve HafÄ±za oyunlarÄ±. Mobil uyumlu." />
<link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;700&display=swap" rel="stylesheet">
<link rel="manifest" href="manifest.json">
<link rel="stylesheet" href="styles.css" />
</head>
<body>
<header class="site-header">
<div class="bar">
<a class="logo" href="/">Matematik OyunlarÄ±</a>
</div>
<div class="subbar">
<div class="tabs">
<button class="tab active" data-target="home">Ana Sayfa</button>
<button class="tab" data-target="ilkokul">Ä°LKOKUL</button>
<button class="tab" data-target="ortaokul">ORTAOKUL (6. SÄ±nÄ±f)</button>
<button class="tab" data-target="hafiza">HAFIZA OYUNLARI</button>
</div>
</div>
</header>
<main class="container">
<section id="home" class="panel">
<h1>HoÅŸ geldin! Bir seviye seÃ§ ve oyna.</h1>
<p><strong>Kurallar:</strong> Her oyun 60 saniye sÃ¼rer. Her doÄŸru cevap <strong>10 puan</strong>, arka arkaya <strong>3 doÄŸru</strong> yapÄ±nca <strong>+15 bonus puan</strong>!</p>
<div class="cards">
<article class="card"><h3>Ä°LKOKUL</h3><div class="card-actions"><button class="btn go" data-target="ilkokul">Git</button></div></article>
<article class="card"><h3>ORTAOKUL (6. SÄ±nÄ±f)</h3><div class="card-actions"><button class="btn go" data-target="ortaokul">Git</button></div></article>
<article class="card"><h3>HAFIZA OYUNLARI</h3><div class="card-actions"><button class="btn go" data-target="hafiza">Git</button></div></article>
</div>
</section>

<section id="ilkokul" class="panel hidden">
<h2>Ä°LKOKUL OYUNLARI</h2>
<div class="cards">
<article class="card"><h3>Toplama</h3><div class="card-actions"><button class="btn go" data-target="addition">Oyna</button></div></article>
<article class="card"><h3>Ã‡Ä±karma</h3><div class="card-actions"><button class="btn go" data-target="subtraction">Oyna</button></div></article>
<article class="card"><h3>Ã‡arpma</h3><div class="card-actions"><button class="btn go" data-target="multiplication">Oyna</button></div></article>
<article class="card"><h3>BÃ¶lme</h3><div class="card-actions"><button class="btn go" data-target="division">Oyna</button></div></article>
</div>
<div class="back"><button class="btn tab" data-target="home">Geri</button></div>
</section>

<section id="ortaokul" class="panel hidden">
<h2>ORTAOKUL (6. SINIF) OYUNLARI</h2>
<div class="cards">
<article class="card"><h3>Asal SayÄ±lar</h3><div class="card-actions"><button class="btn go" data-target="primes">Oyna</button></div></article>
<article class="card"><h3>Ã‡arpanlar</h3><div class="card-actions"><button class="btn go" data-target="factors">Oyna</button></div></article>
<article class="card"><h3>EBOB / EKOK</h3><div class="card-actions"><button class="btn go" data-target="gcdlcm">Oyna</button></div></article>
<article class="card"><h3>Denk Kesirler</h3><div class="card-actions"><button class="btn go" data-target="frac6">Oyna</button></div></article>
<article class="card"><h3>Tam SayÄ±lÄ± â†’ BileÅŸik</h3><div class="card-actions"><button class="btn go" data-target="mixed">Oyna</button></div></article>
<article class="card"><h3>Ortalama / Ortanca / Tepe</h3><div class="card-actions"><button class="btn go" data-target="stats">Oyna</button></div></article>
</div>
<div class="back"><button class="btn tab" data-target="home">Geri</button></div>
</section>

<section id="hafiza" class="panel hidden">
<h2>HAFIZA OYUNLARI</h2>
<div class="cards">
<article class="card"><h3>Åžekiller</h3><div class="card-actions"><button class="btn go" data-target="shapes">Oyna</button></div></article>
<article class="card"><h3>HafÄ±za KartlarÄ±</h3><div class="card-actions"><button class="btn go" data-target="memory">Oyna</button></div></article>
</div>
<div class="back"><button class="btn tab" data-target="home">Geri</button></div>
</section>

<!-- TÃ¼m Oyun Panelleri -->
<section id="addition" class="panel hidden">
<h2>Toplama Oyunu</h2>
<div class="game-area">
<div class="status-row">
<span>Skor: <span id="add-score">0</span></span>
<span>SÃ¼re: <span id="add-time">60</span> sn</span>
</div>
<div class="question" id="add-question"></div>
<div class="answers" id="add-answers"></div>
</div>
<div class="game-header controls" style="margin-top:1rem;">
<button class="btn" onclick="window.renderLeaderboardForGame('addition')">En YÃ¼ksek Skorlar</button>
<button class="btn" onclick="window.submitScoreUI('addition')">Bitir ve Skor GÃ¶nder</button>
<button class="btn tab" data-target="ilkokul">Geri</button>
</div>
</section>

<section id="subtraction" class="panel hidden">
<h2>Ã‡Ä±karma Oyunu</h2>
<div class="game-area">
<div class="status-row">
<span>Skor: <span id="sub-score">0</span></span>
<span>SÃ¼re: <span id="sub-time">60</span> sn</span>
</div>
<div class="question" id="sub-question"></div>
<div class="answers" id="sub-answers"></div>
</div>
<div class="game-header controls" style="margin-top:1rem;">
<button class="btn" onclick="window.renderLeaderboardForGame('subtraction')">En YÃ¼ksek Skorlar</button>
<button class="btn" onclick="window.submitScoreUI('subtraction')">Bitir ve Skor GÃ¶nder</button>
<button class="btn tab" data-target="ilkokul">Geri</button>
</div>
</section>

<section id="multiplication" class="panel hidden">
<h2>Ã‡arpma Oyunu</h2>
<div class="game-area">
<div class="status-row">
<span>Skor: <span id="mul-score">0</span></span>
<span>SÃ¼re: <span id="mul-time">60</span> sn</span>
</div>
<div class="question" id="mul-question"></div>
<div class="answers" id="mul-answers"></div>
</div>
<div class="game-header controls" style="margin-top:1rem;">
<button class="btn" onclick="window.renderLeaderboardForGame('multiplication')">En YÃ¼ksek Skorlar</button>
<button class="btn" onclick="window.submitScoreUI('multiplication')">Bitir ve Skor GÃ¶nder</button>
<button class="btn tab" data-target="ilkokul">Geri</button>
</div>
</section>

<section id="division" class="panel hidden">
<h2>BÃ¶lme Oyunu</h2>
<div class="game-area">
<div class="status-row">
<span>Skor: <span id="div-score">0</span></span>
<span>SÃ¼re: <span id="div-time">60</span> sn</span>
</div>
<div class="question" id="div-question"></div>
<div class="answers" id="div-answers"></div>
</div>
<div class="game-header controls" style="margin-top:1rem;">
<button class="btn" onclick="window.renderLeaderboardForGame('division')">En YÃ¼ksek Skorlar</button>
<button class="btn" onclick="window.submitScoreUI('division')">Bitir ve Skor GÃ¶nder</button>
<button class="btn tab" data-target="ilkokul">Geri</button>
</div>
</section>

<section id="primes" class="panel hidden">
<h2>Asal SayÄ±lar Oyunu</h2>
<div class="game-area">
<div class="status-row">
<span>Skor: <span id="prime-score">0</span></span>
<span>SÃ¼re: <span id="prime-time">60</span> sn</span>
</div>
<div class="question" id="prime-question"></div>
<div class="answers" id="prime-answers"></div>
</div>
<div class="game-header controls" style="margin-top:1rem;">
<button class="btn" onclick="window.renderLeaderboardForGame('primes')">En YÃ¼ksek Skorlar</button>
<button class="btn" onclick="window.submitScoreUI('primes')">Bitir ve Skor GÃ¶nder</button>
<button class="btn tab" data-target="ortaokul">Geri</button>
</div>
</section>

<section id="factors" class="panel hidden">
<h2>Ã‡arpanlar Oyunu</h2>
<div class="game-area">
<div class="status-row">
<span>Skor: <span id="fac-score">0</span></span>
<span>SÃ¼re: <span id="fac-time">60</span> sn</span>
</div>
<div class="question" id="fac-question"></div>
<div class="answers" id="fac-answers"></div>
</div>
<div class="game-header controls" style="margin-top:1rem;">
<button class="btn" onclick="window.renderLeaderboardForGame('factors')">En YÃ¼ksek Skorlar</button>
<button class="btn" onclick="window.submitScoreUI('factors')">Bitir ve Skor GÃ¶nder</button>
<button class="btn tab" data-target="ortaokul">Geri</button>
</div>
</section>

<section id="gcdlcm" class="panel hidden">
<h2>EBOB / EKOK Oyunu</h2>
<div class="game-area">
<div class="status-row">
<span>Skor: <span id="gcd-score">0</span></span>
<span>SÃ¼re: <span id="gcd-time">60</span> sn</span>
</div>
<div class="question" id="gcd-question"></div>
<div class="answers" id="gcd-answers"></div>
</div>
<div class="game-header controls" style="margin-top:1rem;">
<button class="btn" onclick="window.renderLeaderboardForGame('gcdlcm')">En YÃ¼ksek Skorlar</button>
<button class="btn" onclick="window.submitScoreUI('gcdlcm')">Bitir ve Skor GÃ¶nder</button>
<button class="btn tab" data-target="ortaokul">Geri</button>
</div>
</section>

<section id="frac6" class="panel hidden">
<h2>Denk Kesirler Oyunu</h2>
<div class="game-area">
<div class="status-row">
<span>Skor: <span id="frac-score">0</span></span>
<span>SÃ¼re: <span id="frac-time">60</span> sn</span>
</div>
<div class="question" id="frac-question"></div>
<div class="answers" id="frac-answers"></div>
</div>
<div class="game-header controls" style="margin-top:1rem;">
<button class="btn" onclick="window.renderLeaderboardForGame('frac6')">En YÃ¼ksek Skorlar</button>
<button class="btn" onclick="window.submitScoreUI('frac6')">Bitir ve Skor GÃ¶nder</button>
<button class="btn tab" data-target="ortaokul">Geri</button>
</div>
</section>

<section id="mixed" class="panel hidden">
<h2>Tam SayÄ±lÄ± â†’ BileÅŸik Kesir</h2>
<div class="game-area">
<div class="status-row">
<span>Skor: <span id="mix-score">0</span></span>
<span>SÃ¼re: <span id="mix-time">60</span> sn</span>
</div>
<div class="question" id="mix-question"></div>
<div class="answers" id="mix-answers"></div>
</div>
<div class="game-header controls" style="margin-top:1rem;">
<button class="btn" onclick="window.renderLeaderboardForGame('mixed')">En YÃ¼ksek Skorlar</button>
<button class="btn" onclick="window.submitScoreUI('mixed')">Bitir ve Skor GÃ¶nder</button>
<button class="btn tab" data-target="ortaokul">Geri</button>
</div>
</section>

<section id="stats" class="panel hidden">
<h2>Ortalama / Ortanca / Tepe DeÄŸer</h2>
<div class="game-area">
<div class="status-row">
<span>Skor: <span id="stat-score">0</span></span>
<span>SÃ¼re: <span id="stat-time">60</span> sn</span>
</div>
<div class="question" id="stat-question"></div>
<div class="answers" id="stat-answers"></div>
</div>
<div class="game-header controls" style="margin-top:1rem;">
<button class="btn" onclick="window.renderLeaderboardForGame('stats')">En YÃ¼ksek Skorlar</button>
<button class="btn" onclick="window.submitScoreUI('stats')">Bitir ve Skor GÃ¶nder</button>
<button class="btn tab" data-target="ortaokul">Geri</button>
</div>
</section>

<section id="shapes" class="panel hidden">
<h2>Åžekiller Oyunu</h2>
<div class="game-area">
<div class="status-row">
<span>Skor: <span id="shape-score">0</span></span>
<span>SÃ¼re: <span id="shape-time">60</span> sn</span>
</div>
<div class="question" style="font-size:1.4rem;margin-bottom:1rem;">Hedef: <div id="target-shape-display" class="shape" style="display:inline-block;margin-left:1rem;"></div></div>
<div class="mem-board" id="shape-board" style="grid-template-columns:repeat(4,1fr);"></div>
</div>
<div class="game-header controls" style="margin-top:1rem;">
<button class="btn" onclick="window.renderLeaderboardForGame('shapes')">En YÃ¼ksek Skorlar</button>
<button class="btn" onclick="window.submitScoreUI('shapes')">Bitir ve Skor GÃ¶nder</button>
<button class="btn tab" data-target="hafiza">Geri</button>
</div>
</section>

<section id="memory" class="panel hidden">
<h2>HafÄ±za KartlarÄ±</h2>
<div class="game-area">
<div class="status-row">
<span>Skor: <span id="mem-score">0</span></span>
<span>SÃ¼re: <span id="mem-time">60</span> sn</span>
<span>Ã‡ift: <span id="mem-pairs">0</span>/8</span>
</div>
<div class="mem-board" id="mem-board"></div>
</div>
<div class="game-header controls" style="margin-top:1rem;">
<button class="btn" onclick="window.renderLeaderboardForGame('memory')">En YÃ¼ksek Skorlar</button>
<button class="btn" onclick="window.submitScoreUI('memory')">Bitir ve Skor GÃ¶nder</button>
<button class="btn tab" data-target="hafiza">Geri</button>
</div>
</section>

<section id="leaderboard" class="panel hidden">
<h2 id="lb-title">Leaderboard</h2>
<div id="lb-list" class="card" style="padding:0.6rem">YÃ¼kleniyor...</div>
<div class="small muted" id="lb-source-note" style="margin-top:0.6rem">Kaynak:</div>
<div style="margin-top:0.6rem"><button class="btn tab" data-target="home">Kapat</button></div>
</section>
</main>

<footer class="site-footer">
<div class="container">
<p>Â© <span id="year"></span> Matbilzek â€” FF EÄŸitsel Matematik OyunlarÄ±</p>
<p class="muted small">60 sn â€¢ 10 puan â€¢ 3 doÄŸru = +15 bonus</p>
</div>
</footer>

<script>
document.getElementById('year').textContent = new Date().getFullYear();

if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('/sw.js').catch(() => {});
}
</script>

<script>
let currentTimer = null;

const gameInitFunctions = {
  addition: function() {
    let score = 0, time = 60, combo = 0;
    const scoreEl = document.getElementById('add-score');
    const timeEl = document.getElementById('add-time');
    scoreEl.textContent = score;
    timeEl.textContent = time;

    currentTimer = setInterval(() => {
      time--;
      timeEl.textContent = time;
      if (time <= 0) {
        clearInterval(currentTimer);
        currentTimer = null;
        window._saveLocalScore('addition', score);
      }
    }, 1000);

    function gen() {
      // 3 basamaklÄ± sayÄ±lar: 100-999
      const a = Math.floor(Math.random() * 900) + 100;
      const b = Math.floor(Math.random() * 900) + 100;
      const correct = a + b;  // Toplam en fazla 1998 olacak

      let opts = [correct];
      while (opts.length < 4) {
        // YanlÄ±ÅŸ ÅŸÄ±klarÄ± doÄŸru cevaba yakÄ±n Ã¼ret (Â±50 civarÄ±), negatif olmamasÄ± iÃ§in kontrol
        let w = correct + Math.floor(Math.random() * 101) - 50;  // -50 ile +50 arasÄ±
        if (w > 0 && !opts.includes(w) && w !== correct) {
          opts.push(w);
        }
      }
      opts.sort(() => Math.random() - 0.5);

      document.getElementById('add-question').textContent = `${a} + ${b} = ?`;
      const ans = document.getElementById('add-answers');
      ans.innerHTML = '';

      opts.forEach(o => {
        const btn = document.createElement('button');
        btn.className = 'answer-btn';
        btn.textContent = o;
        btn.onclick = () => {
          if (btn.disabled) return;
          document.querySelectorAll('#add-answers button').forEach(b => b.disabled = true);
          btn.classList.add(o === correct ? 'correct' : 'wrong');

          if (o === correct) {
            score += 10;
            combo++;
            if (combo % 3 === 0) score += 15;
          } else {
            combo = 0;
          }
          scoreEl.textContent = score;

          setTimeout(() => {
            document.querySelectorAll('#add-answers button').forEach(b => {
              b.disabled = false;
              b.classList.remove('correct', 'wrong');
            });
            gen();
          }, 800);
        };
        ans.appendChild(btn);
      });
    }
    gen();
  },

  subtraction: function() {
    let score = 0, time = 60, combo = 0;
    const scoreEl = document.getElementById('sub-score');
    const timeEl = document.getElementById('sub-time');
    scoreEl.textContent = score;
    timeEl.textContent = time;

    currentTimer = setInterval(() => {
      time--;
      timeEl.textContent = time;
      if (time <= 0) {
        clearInterval(currentTimer);
        currentTimer = null;
        window._saveLocalScore('subtraction', score);
      }
    }, 1000);

    function gen() {
      // 3 basamaklÄ± bÃ¼yÃ¼k sayÄ±
      const a = Math.floor(Math.random() * 900) + 100; // 100-999
      // b, a'dan kÃ¼Ã§Ã¼k veya eÅŸit olsun (sonuÃ§ negatif olmasÄ±n)
      const b = Math.floor(Math.random() * a);
      const correct = a - b;

      let opts = [correct];
      while (opts.length < 4) {
        // YanlÄ±ÅŸ ÅŸÄ±klarÄ± doÄŸru cevaba yakÄ±n Ã¼ret (Â±50 civarÄ±)
        let w = correct + Math.floor(Math.random() * 101) - 50; // -50 ile +50 arasÄ±
        if (w >= 0 && !opts.includes(w) && w !== correct) {
          opts.push(w);
        }
      }
      opts.sort(() => Math.random() - 0.5);

      document.getElementById('sub-question').textContent = `${a} - ${b} = ?`;
      const ans = document.getElementById('sub-answers');
      ans.innerHTML = '';

      opts.forEach(o => {
        const btn = document.createElement('button');
        btn.className = 'answer-btn';
        btn.textContent = o;
        btn.onclick = () => {
          if (btn.disabled) return;
          document.querySelectorAll('#sub-answers button').forEach(b => b.disabled = true);
          btn.classList.add(o === correct ? 'correct' : 'wrong');

          if (o === correct) {
            score += 10;
            combo++;
            if (combo % 3 === 0) score += 15;
          } else {
            combo = 0;
          }
          scoreEl.textContent = score;

          setTimeout(() => {
            document.querySelectorAll('#sub-answers button').forEach(b => {
              b.disabled = false;
              b.classList.remove('correct', 'wrong');
            });
            gen();
          }, 800);
        };
        ans.appendChild(btn);
      });
    }
    gen();
  },

              
  multiplication: function() {
    let score = 0, time = 60, combo = 0;
    const scoreEl = document.getElementById('mul-score');
    const timeEl = document.getElementById('mul-time');
    scoreEl.textContent = score;
    timeEl.textContent = time;

    currentTimer = setInterval(() => {
      time--;
      timeEl.textContent = time;
      if (time <= 0) {
        clearInterval(currentTimer);
        currentTimer = null;
        window._saveLocalScore('multiplication', score);
      }
    }, 1000);

    function gen() {
      // Rastgele Ã§arpma tipi seÃ§iyoruz
      const type = Math.floor(Math.random() * 5); // 0-4 arasÄ± 5 farklÄ± tip

      let a, b;

      if (type === 0) {
        // 3 basamaklÄ± Ã— 1 basamaklÄ±
        a = Math.floor(Math.random() * 900) + 100; // 100-999
        b = Math.floor(Math.random() * 9) + 1;     // 1-9
      } else if (type === 1) {
        // 3 basamaklÄ± Ã— 2 basamaklÄ±
        a = Math.floor(Math.random() * 900) + 100; // 100-999
        b = Math.floor(Math.random() * 90) + 10;   // 10-99
      } else if (type === 2) {
        // 3 basamaklÄ± Ã— 3 basamaklÄ±
        a = Math.floor(Math.random() * 900) + 100; // 100-999
        b = Math.floor(Math.random() * 900) + 100; // 100-999
      } else if (type === 3) {
        // 2 basamaklÄ± Ã— 1 basamaklÄ±
        a = Math.floor(Math.random() * 90) + 10;   // 10-99
        b = Math.floor(Math.random() * 9) + 1;     // 1-9
      } else {
        // 2 basamaklÄ± Ã— 2 basamaklÄ±
        a = Math.floor(Math.random() * 90) + 10;   // 10-99
        b = Math.floor(Math.random() * 90) + 10;   // 10-99
      }

      const correct = a * b;

      // YanlÄ±ÅŸ ÅŸÄ±klar: doÄŸru cevaba yakÄ±n deÄŸerler Ã¼retelim
      let opts = [correct];
      while (opts.length < 4) {
        // DoÄŸru cevabÄ±n yaklaÅŸÄ±k Â±15% farkla yanlÄ±ÅŸ ÅŸÄ±klar
        const deviation = Math.floor(correct * 0.15);
        let w = correct + Math.floor(Math.random() * (deviation * 2 + 1)) - deviation;

        // Negatif olmasÄ±n ve zaten listede olmasÄ±n
        if (w > 0 && !opts.includes(w)) {
          opts.push(w);
        }
      }

      opts.sort(() => Math.random() - 0.5);

      document.getElementById('mul-question').textContent = `${a} Ã— ${b} = ?`;
      const ans = document.getElementById('mul-answers');
      ans.innerHTML = '';

      opts.forEach(o => {
        const btn = document.createElement('button');
        btn.className = 'answer-btn';
        btn.textContent = o;
        btn.onclick = () => {
          if (btn.disabled) return;
          document.querySelectorAll('#mul-answers button').forEach(b => b.disabled = true);
          btn.classList.add(o === correct ? 'correct' : 'wrong');

          if (o === correct) {
            score += 10;
            combo++;
            if (combo % 3 === 0) score += 15;
          } else {
            combo = 0;
          }
          scoreEl.textContent = score;

          setTimeout(() => {
            document.querySelectorAll('#mul-answers button').forEach(b => {
              b.disabled = false;
              b.classList.remove('correct', 'wrong');
            });
            gen();
          }, 800);
        };
        ans.appendChild(btn);
      });
    }
    gen();
  },


division: function() {
    let score = 0, time = 60, combo = 0;
    const scoreEl = document.getElementById('div-score');
    const timeEl = document.getElementById('div-time');
    scoreEl.textContent = score;
    timeEl.textContent = time;

    currentTimer = setInterval(() => {
      time--;
      timeEl.textContent = time;
      if (time <= 0) {
        clearInterval(currentTimer);
        currentTimer = null;
        window._saveLocalScore('division', score);
      }
    }, 1000);

    function gen() {
      // Rastgele bÃ¶len (divisor): 2 veya 3 basamaklÄ±, 11-99 arasÄ± (10 ve 5 ile kolay bÃ¶lÃ¼nebilirlik iÃ§in tercihli)
      const digitCount = Math.random() < 0.7 ? 2 : 3; // %70 2 basamaklÄ±, %30 3 basamaklÄ±
      let divisor;
      if (digitCount === 2) {
        // 2 basamaklÄ±: 11-99, Ã¶zellikle 10, 20, 25, 30, 40, 50, 60, 75, 80 gibi kolay olanlar aÄŸÄ±rlÄ±klÄ±
        const easyDivisors = [10, 12, 15, 20, 25, 30, 40, 50, 60, 75, 80, 90];
        divisor = easyDivisors[Math.floor(Math.random() * easyDivisors.length)];
      } else {
        // 3 basamaklÄ± nadir, ama mÃ¼mkÃ¼n (Ã¶rneÄŸin 100, 125, 150 gibi)
        const easyBig = [100, 125, 150, 200, 250, 300, 400, 500];
        divisor = easyBig[Math.floor(Math.random() * easyBig.length)];
      }

      // BÃ¶lÃ¼m (quotient): 5-50 arasÄ± (sonuÃ§ mantÄ±klÄ± ve zihinden hesaplanabilir olsun)
      const quotient = Math.floor(Math.random() * 46) + 5; // 5-50

      // BÃ¶lÃ¼nen sayÄ±: divisor * quotient â†’ tam bÃ¶lÃ¼nÃ¼yor ve genellikle 0 ile bitiyor
      const dividend = divisor * quotient;

      const correct = quotient;

      // YanlÄ±ÅŸ ÅŸÄ±klar: doÄŸru cevaba yakÄ±n (Â±10 civarÄ±), pozitif ve tekrarsÄ±z
      let opts = [correct];
      while (opts.length < 4) {
        let w = correct + Math.floor(Math.random() * 21) - 10; // -10 ile +10 arasÄ±
        if (w > 0 && !opts.includes(w)) {
          opts.push(w);
        }
      }

      opts.sort(() => Math.random() - 0.5);

      document.getElementById('div-question').textContent = `${dividend} Ã· ${divisor} = ?`;
      const ans = document.getElementById('div-answers');
      ans.innerHTML = '';

      opts.forEach(o => {
        const btn = document.createElement('button');
        btn.className = 'answer-btn';
        btn.textContent = o;
        btn.onclick = () => {
          if (btn.disabled) return;
          document.querySelectorAll('#div-answers button').forEach(b => b.disabled = true);
          btn.classList.add(o === correct ? 'correct' : 'wrong');

          if (o === correct) {
            score += 10;
            combo++;
            if (combo % 3 === 0) score += 15;
          } else {
            combo = 0;
          }
          scoreEl.textContent = score;

          setTimeout(() => {
            document.querySelectorAll('#div-answers button').forEach(b => {
              b.disabled = false;
              b.classList.remove('correct', 'wrong');
            });
            gen();
          }, 800);
        };
        ans.appendChild(btn);
      });
    }
    gen();
  },
  
  primes: function() {
    let score = 0, time = 60, combo = 0;
    const scoreEl = document.getElementById('prime-score');
    const timeEl = document.getElementById('prime-time');
    scoreEl.textContent = score;
    timeEl.textContent = time;
    currentTimer = setInterval(() => {
      time--;
      timeEl.textContent = time;
      if (time <= 0) {
        clearInterval(currentTimer);
        currentTimer = null;
        window._saveLocalScore('primes', score);
      }
    }, 1000);

    const isPrime = n => {
      if (n <= 1) return false;
      for (let i = 2; i <= Math.sqrt(n); i++) if (n % i === 0) return false;
      return true;
    };

    function gen() {
      const num = Math.floor(Math.random() * 99) + 2;
      const correct = isPrime(num) ? 'Evet' : 'HayÄ±r';
      document.getElementById('prime-question').textContent = `${num} asal sayÄ± mÄ±?`;
      const ans = document.getElementById('prime-answers'); ans.innerHTML = '';
      ['Evet', 'HayÄ±r'].forEach(o => {
        const btn = document.createElement('button');
        btn.className = 'answer-btn';
        btn.textContent = o;
        btn.onclick = () => {
          if (btn.disabled) return;
          document.querySelectorAll('#prime-answers button').forEach(b => b.disabled = true);
          btn.classList.add(o === correct ? 'correct' : 'wrong');
          if (o === correct) {
            score += 10; combo++;
            if (combo % 3 === 0) score += 15;
          } else combo = 0;
          scoreEl.textContent = score;
          setTimeout(() => {
            document.querySelectorAll('#prime-answers button').forEach(b => {
              b.disabled = false; b.classList.remove('correct', 'wrong');
            });
            gen();
          }, 800);
        };
        ans.appendChild(btn);
      });
    }
    gen();
  },

  factors: function() {
    let score = 0, time = 60, combo = 0;
    const scoreEl = document.getElementById('fac-score');
    const timeEl = document.getElementById('fac-time');
    scoreEl.textContent = score;
    timeEl.textContent = time;
    currentTimer = setInterval(() => {
      time--;
      timeEl.textContent = time;
      if (time <= 0) {
        clearInterval(currentTimer);
        currentTimer = null;
        window._saveLocalScore('factors', score);
      }
    }, 1000);

    const getFactorsStr = n => {
      let f = [];
      for (let i = 1; i <= n; i++) if (n % i === 0) f.push(i);
      return f.join(', ');
    };

    function gen() {
      const num = Math.floor(Math.random() * 50) + 10;
      const correct = getFactorsStr(num);
      let opts = [correct];
      while (opts.length < 4) {
        const wrongNum = num + Math.floor(Math.random() * 10 - 5);
        const w = wrongNum > 1 ? getFactorsStr(wrongNum) : '1';
        if (!opts.includes(w)) opts.push(w);
      }
      opts.sort(() => Math.random() - 0.5);
      document.getElementById('fac-question').textContent = `${num} sayÄ±sÄ±nÄ±n Ã§arpanlarÄ±?`;
      const ans = document.getElementById('fac-answers'); ans.innerHTML = '';
      opts.forEach(o => {
        const btn = document.createElement('button');
        btn.className = 'answer-btn';
        btn.textContent = o;
        btn.onclick = () => {
          if (btn.disabled) return;
          document.querySelectorAll('#fac-answers button').forEach(b => b.disabled = true);
          btn.classList.add(o === correct ? 'correct' : 'wrong');
          if (o === correct) {
            score += 10; combo++;
            if (combo % 3 === 0) score += 15;
          } else combo = 0;
          scoreEl.textContent = score;
          setTimeout(() => {
            document.querySelectorAll('#fac-answers button').forEach(b => {
              b.disabled = false; b.classList.remove('correct', 'wrong');
            });
            gen();
          }, 800);
        };
        ans.appendChild(btn);
      });
    }
    gen();
  },

  gcdlcm: function() {
    let score = 0, time = 60, combo = 0;
    const scoreEl = document.getElementById('gcd-score');
    const timeEl = document.getElementById('gcd-time');
    scoreEl.textContent = score;
    timeEl.textContent = time;
    currentTimer = setInterval(() => {
      time--;
      timeEl.textContent = time;
      if (time <= 0) {
        clearInterval(currentTimer);
        currentTimer = null;
        window._saveLocalScore('gcdlcm', score);
      }
    }, 1000);

    const gcd = (a, b) => b === 0 ? a : gcd(b, a % b);
    const lcm = (a, b) => (a * b) / gcd(a, b);

    function gen() {
      const a = Math.floor(Math.random() * 30) + 5;
      const b = Math.floor(Math.random() * 30) + 5;
      const isGcd = Math.random() > 0.5;
      const correct = isGcd ? gcd(a, b) : lcm(a, b);
      let opts = [correct];
      while (opts.length < 4) {
        let w = correct + Math.floor(Math.random() * 11 - 5);
        if (w > 0 && !opts.includes(w)) opts.push(w);
      }
      opts.sort(() => Math.random() - 0.5);
      document.getElementById('gcd-question').textContent = `${a} ve ${b}'nin ${isGcd ? 'EBOB' : 'EKOK'}'u?`;
      const ans = document.getElementById('gcd-answers'); ans.innerHTML = '';
      opts.forEach(o => {
        const btn = document.createElement('button');
        btn.className = 'answer-btn';
        btn.textContent = o;
        btn.onclick = () => {
          if (btn.disabled) return;
          document.querySelectorAll('#gcd-answers button').forEach(b => b.disabled = true);
          btn.classList.add(o === correct ? 'correct' : 'wrong');
          if (o === correct) {
            score += 10; combo++;
            if (combo % 3 === 0) score += 15;
          } else combo = 0;
          scoreEl.textContent = score;
          setTimeout(() => {
            document.querySelectorAll('#gcd-answers button').forEach(b => {
              b.disabled = false; b.classList.remove('correct', 'wrong');
            });
            gen();
          }, 800);
        };
        ans.appendChild(btn);
      });
    }
    gen();
  },

  frac6: function() {
    let score = 0, time = 60, combo = 0;
    const scoreEl = document.getElementById('frac-score');
    const timeEl = document.getElementById('frac-time');
    scoreEl.textContent = score;
    timeEl.textContent = time;
    currentTimer = setInterval(() => {
      time--;
      timeEl.textContent = time;
      if (time <= 0) {
        clearInterval(currentTimer);
        currentTimer = null;
        window._saveLocalScore('frac6', score);
      }
    }, 1000);

    function gen() {
      const pay = Math.floor(Math.random() * 10) + 1;
      const payda = Math.floor(Math.random() * 9) + 2;
      const carp = Math.floor(Math.random() * 5) + 2;
      const correct = `${pay * carp}/${payda * carp}`;
      let opts = [correct];
      while (opts.length < 4) {
        const wrongPay = pay * carp + Math.floor(Math.random() * 5 - 2);
        const w = `${wrongPay}/${payda * carp}`;
        if (!opts.includes(w)) opts.push(w);
      }
      opts.sort(() => Math.random() - 0.5);
      document.getElementById('frac-question').innerHTML = `${pay}/${payda} ile denk kesir?`;
      const ans = document.getElementById('frac-answers'); ans.innerHTML = '';
      opts.forEach(o => {
        const btn = document.createElement('button');
        btn.className = 'answer-btn';
        btn.innerHTML = o;
        btn.onclick = () => {
          if (btn.disabled) return;
          document.querySelectorAll('#frac-answers button').forEach(b => b.disabled = true);
          btn.classList.add(o === correct ? 'correct' : 'wrong');
          if (o === correct) {
            score += 10; combo++;
            if (combo % 3 === 0) score += 15;
          } else combo = 0;
          scoreEl.textContent = score;
          setTimeout(() => {
            document.querySelectorAll('#frac-answers button').forEach(b => {
              b.disabled = false; b.classList.remove('correct', 'wrong');
            });
            gen();
          }, 800);
        };
        ans.appendChild(btn);
      });
    }
    gen();
  },

  mixed: function() {
    let score = 0, time = 60, combo = 0;
    const scoreEl = document.getElementById('mix-score');
    const timeEl = document.getElementById('mix-time');
    scoreEl.textContent = score;
    timeEl.textContent = time;
    currentTimer = setInterval(() => {
      time--;
      timeEl.textContent = time;
      if (time <= 0) {
        clearInterval(currentTimer);
        currentTimer = null;
        window._saveLocalScore('mixed', score);
      }
    }, 1000);

    function gen() {
      const tam = Math.floor(Math.random() * 6) + 1;
      const pay = Math.floor(Math.random() * 8) + 1;
      const payda = Math.floor(Math.random() * 7) + 3;
      const correct = `${tam * payda + pay}/${payda}`;
      let opts = [correct];
      while (opts.length < 4) {
        const wrongPay = tam * payda + pay + Math.floor(Math.random() * 9 - 4);
        const w = `${wrongPay}/${payda}`;
        if (!opts.includes(w)) opts.push(w);
      }
      opts.sort(() => Math.random() - 0.5);
      
      document.getElementById('mix-question').innerHTML = `<strong>${tam}</strong> tam <strong>${pay}</strong> bÃ¶lÃ¼ <strong>${payda}</strong> bileÅŸik kesire Ã§evir`;
      
      const ans = document.getElementById('mix-answers'); ans.innerHTML = '';
      
      opts.forEach(o => {
        const btn = document.createElement('button');
        btn.className = 'answer-btn';
        btn.innerHTML = o;
        btn.onclick = () => {
          if (btn.disabled) return;
          document.querySelectorAll('#mix-answers button').forEach(b => b.disabled = true);
          btn.classList.add(o === correct ? 'correct' : 'wrong');
          if (o === correct) {
            score += 10; combo++;
            if (combo % 3 === 0) score += 15;
          } else combo = 0;
          scoreEl.textContent = score;
          setTimeout(() => {
            document.querySelectorAll('#mix-answers button').forEach(b => {
              b.disabled = false; b.classList.remove('correct', 'wrong');
            });
            gen();
          }, 800);
        };
        ans.appendChild(btn);
      });
    }
    gen();
  },

  stats: function() {
  let score = 0, time = 60, combo = 0;
  const scoreEl = document.getElementById('stat-score');
  const timeEl = document.getElementById('stat-time');
  scoreEl.textContent = score;
  timeEl.textContent = time;
  currentTimer = setInterval(() => {
    time--;
    timeEl.textContent = time;
    if (time <= 0) {
      clearInterval(currentTimer);
      currentTimer = null;
      window._saveLocalScore('stats', score);
    }
  }, 1000);

  // Tepe deÄŸer bul: en Ã§ok tekrar eden sayÄ±lar (Ã§oklu olabilir)
  const getModes = arr => {
    const freq = {};
    arr.forEach(n => freq[n] = (freq[n] || 0) + 1);

    let maxCount = 0;
    for (let num in freq) {
      if (freq[num] > maxCount) maxCount = freq[num];
    }

    // Maksimum tekrar sayÄ±sÄ± 1 ise â†’ Yok
    if (maxCount === 1) return ['Yok'];

    // En yÃ¼ksek tekrara sahip tÃ¼m sayÄ±larÄ± topla
    const modes = [];
    for (let num in freq) {
      if (freq[num] === maxCount) modes.push(num);
    }

    // SÄ±ralÄ± olsun diye sort yap
    return modes.sort((a, b) => a - b);
  };

  const mean = arr => (arr.reduce((a,b)=>a+b,0)/arr.length).toFixed(1);
  const median = arr => {
    const s = [...arr].sort((a,b)=>a-b);
    const m = Math.floor(s.length/2);
    return s.length % 2 === 0 ? ((s[m-1] + s[m]) / 2).toFixed(1) : s[m];
  };

  function gen() {
    // 5-8 tane doÄŸal sayÄ±
    const nums = Array.from({length: Math.floor(Math.random() * 4) + 5}, () => Math.floor(Math.random() * 20) + 1);

    const type = Math.floor(Math.random() * 3);
    let correct, qType;

    if (type === 0) {
      correct = mean(nums); // sayÄ± veya x.x formatÄ±nda string
      qType = 'Aritmetik Ortalama';
    } else if (type === 1) {
      correct = median(nums);
      qType = 'Ortanca';
    } else {
      const modes = getModes(nums);
      // DoÄŸru cevap: "Yok" ya da "3 ve 5" gibi birleÅŸtirilmiÅŸ string
      correct = modes.length === 1 && modes[0] === 'Yok' ? 'Yok' : modes.join(' ve ');
      qType = 'Tepe DeÄŸer';
    }

    // SeÃ§enekler oluÅŸtur
    let opts = [correct.toString()];

    while (opts.length < 4) {
      let w;
      if (qType === 'Tepe DeÄŸer') {
        // Tepe iÃ§in mantÄ±klÄ± yanlÄ±ÅŸ seÃ§enekler
        if (Math.random() < 0.3 && !opts.includes('Yok')) {
          w = 'Yok';
        } else {
          // Rastgele bir sayÄ± veya yanlÄ±ÅŸ birleÅŸtirme
          const randomNum = Math.floor(Math.random() * 20) + 1;
          const another = Math.floor(Math.random() * 20) + 1;
          w = randomNum === another ? randomNum.toString() : `${randomNum} ve ${another}`;
        }
      } else {
        // Ortalama ve ortanca iÃ§in
        w = (parseFloat(correct) + (Math.random() * 4 - 2)).toFixed(1);
      }
      if (!opts.includes(w)) opts.push(w);
    }

    opts.sort(() => Math.random() - 0.5);

    document.getElementById('stat-question').textContent = 
      `${nums.join(', ')} sayÄ±larÄ±nÄ±n ${qType}'si nedir?`;

    const ans = document.getElementById('stat-answers');
    ans.innerHTML = '';

    opts.forEach(o => {
      const btn = document.createElement('button');
      btn.className = 'answer-btn';
      btn.textContent = o;
      btn.onclick = () => {
        if (btn.disabled) return;
        document.querySelectorAll('#stat-answers button').forEach(b => b.disabled = true);

        // DoÄŸru kontrol: string karÅŸÄ±laÅŸtÄ±rma
        const isCorrect = o === correct.toString();
        btn.classList.add(isCorrect ? 'correct' : 'wrong');

        if (isCorrect) {
          score += 10; combo++;
          if (combo % 3 === 0) score += 15;
        } else {
          combo = 0;
        }
        scoreEl.textContent = score;

        setTimeout(() => {
          document.querySelectorAll('#stat-answers button').forEach(b => {
            b.disabled = false;
            b.classList.remove('correct', 'wrong');
          });
          gen();
        }, 800);
      };
      ans.appendChild(btn);
    });
  }
  gen();
},

  shapes: function() {
    let score = 0, time = 60, combo = 0;
    const scoreEl = document.getElementById('shape-score');
    const timeEl = document.getElementById('shape-time');
    scoreEl.textContent = score;
    timeEl.textContent = time;
    currentTimer = setInterval(() => {
      time--;
      timeEl.textContent = time;
      if (time <= 0) {
        clearInterval(currentTimer);
        currentTimer = null;
        window._saveLocalScore('shapes', score);
      }
    }, 1000);

    const shapes = ['circle','square','triangle','star'];

    function gen() {
      const target = shapes[Math.floor(Math.random()*4)];
      document.getElementById('target-shape-display').className = `shape ${target}`;
      const board = document.getElementById('shape-board'); board.innerHTML = '';
      let cards = [target, target];
      while (cards.length < 8) {
        cards.push(shapes.filter(s=>s!==target)[Math.floor(Math.random()*3)]);
      }
      cards.sort(() => Math.random() - 0.5);
      cards.forEach(sh => {
        const div = document.createElement('div');
        div.className = `shape ${sh}`;
        div.onclick = () => {
          if (div.dataset.clicked) return;
          div.dataset.clicked = '1';
          if (sh === target) {
            score += 10; combo++;
            if (combo % 3 === 0) score += 15;
            div.style.background = '#b2ffba';
          } else {
            combo = 0;
            div.style.background = '#ff9e9e';
          }
          scoreEl.textContent = score;
          setTimeout(gen, 600);
        };
        board.appendChild(div);
      });
    }
    gen();
  },

  memory: function() {
    let score = 0, time = 60, combo = 0, pairsFound = 0, flipped = [], lock = false;
    const scoreEl = document.getElementById('mem-score');
    const pairsEl = document.getElementById('mem-pairs');
    const timeEl = document.getElementById('mem-time');
    scoreEl.textContent = score;
    pairsEl.textContent = pairsFound;
    timeEl.textContent = time;
    currentTimer = setInterval(() => {
      time--;
      timeEl.textContent = time;
      if (time <= 0) {
        clearInterval(currentTimer);
        currentTimer = null;
        window._saveLocalScore('memory', score);
      }
    }, 1000);

    const symbols = ['ðŸŽ','ðŸŒ','ðŸ‡','ðŸŠ','ðŸ‰','ðŸ“','ðŸ¥','ðŸ','ðŸŽ','ðŸŒ','ðŸ‡','ðŸŠ','ðŸ‰','ðŸ“','ðŸ¥','ðŸ'].sort(() => Math.random() - 0.5);
    const board = document.getElementById('mem-board');
    board.innerHTML = '';
    symbols.forEach(sym => {
      const card = document.createElement('div');
      card.className = 'mem-card';
      card.dataset.symbol = sym;
      card.onclick = () => {
        if (lock || flipped.length === 2 || card.classList.contains('flipped')) return;
        card.classList.add('flipped');
        card.textContent = sym;
        flipped.push(card);
        if (flipped.length === 2) {
          lock = true;
          setTimeout(() => {
            if (flipped[0].dataset.symbol === flipped[1].dataset.symbol) {
              flipped.forEach(c => c.classList.add('matched'));
              pairsFound++;
              score += 10; combo++;
              if (combo % 3 === 0) score += 15;
              pairsEl.textContent = pairsFound;
              if (pairsFound === 8) {
                clearInterval(currentTimer);
                currentTimer = null;
                window._saveLocalScore('memory', score);
              }
            } else {
              flipped.forEach(c => { c.classList.remove('flipped'); c.textContent = ''; });
              combo = 0;
            }
            scoreEl.textContent = score;
            flipped = [];
            lock = false;
          }, 1000);
        }
      };
      board.appendChild(card);
    });
  }
};

// Panel ve oyun geÃ§iÅŸ yÃ¶netimi
document.addEventListener('click', function(e) {
  if (e.target.matches('.tab') || e.target.matches('.go')) {
    const targetId = e.target.dataset.target;

    // TÃ¼m panelleri gizle
    document.querySelectorAll('.panel').forEach(p => p.classList.add('hidden'));

    // Hedef paneli gÃ¶ster
    const targetPanel = document.getElementById(targetId);
    if (targetPanel) targetPanel.classList.remove('hidden');

    // Tab aktifliÄŸini gÃ¼ncelle
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    const activeTab = document.querySelector(`.tab[data-target="${targetId}"]`);
    if (activeTab) activeTab.classList.add('active');

    // EÄŸer oyun paneliyse baÅŸlat
    if (gameInitFunctions[targetId]) {
      if (currentTimer) clearInterval(currentTimer);
      currentTimer = null;

      const scoreEls = targetPanel.querySelectorAll('[id$="-score"]');
      scoreEls.forEach(el => el.textContent = '0');
      const timeEls = targetPanel.querySelectorAll('[id$="-time"]');
      timeEls.forEach(el => el.textContent = '60');
      if (targetPanel.querySelector('#mem-pairs')) targetPanel.querySelector('#mem-pairs').textContent = '0';

      gameInitFunctions[targetId]();
    }
  }
});
</script>

<script src="app.js"></script>
</body>
</html>
